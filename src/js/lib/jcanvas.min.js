/*
 jCanvas v14.01.12
 Copyright 2014 Caleb Evans
 Released under the MIT license
*/
(function(f,ta,ua,Ua,da,ja,x,C,g,r){function H(d){var c;if(O.future.inheritance)for(c in d)d.hasOwnProperty(c)&&(this[c]=d[c]);else Y(this,d)}function O(d){var c;if(d)Y(Z,d);else for(c in Z)Z.hasOwnProperty(c)&&delete Z[c];return this}function va(){}function ka(d){return"string"===$(d)}function J(d){return d&&d.getContext?d.getContext("2d"):g}function la(d){d=Y({},d);d.masks=d.masks.slice(0);return d}function ea(d,c){var a;d.save();a=la(c.transforms);c.savedTransforms.push(a)}function wa(d,c,a,b){a[b]&&
(ba(a[b])?c[b]=a[b].call(d,a):c[b]=a[b])}function T(d,c,a){wa(d,c,a,"fillStyle");wa(d,c,a,"strokeStyle");c.lineWidth=a.strokeWidth;a.rounded?c.lineCap=c.lineJoin="round":(c.lineCap=a.strokeCap,c.lineJoin=a.strokeJoin,c.miterLimit=a.miterLimit);c.shadowOffsetX=a.shadowX;c.shadowOffsetY=a.shadowY;c.shadowBlur=a.shadowBlur;c.shadowColor=a.shadowColor;c.globalAlpha=a.opacity;c.globalCompositeOperation=a.compositing;a.imageSmoothing&&(c.webkitImageSmoothingEnabled=c.mozImageSmoothingEnabled=a.imageSmoothing)}
function xa(d,c,a){a.mask&&(a.autosave&&ea(d,c),d.clip(),c.transforms.masks.push(a._args))}function W(d,c,a){a.closed&&c.closePath();a.shadowStroke&&0!==a.strokeWidth?(c.stroke(),c.fill(),c.shadowColor="transparent",c.shadowBlur=0,c.stroke()):(c.fill(),"transparent"!==a.fillStyle&&(c.shadowColor="transparent"),0!==a.strokeWidth&&c.stroke());a.closed||c.closePath();a._transformed&&c.restore();a.mask&&(d=D(d),xa(c,d,a))}function ya(d,c,a){c._toRad=c.inDegrees?L/180:1;d.translate(c.x,c.y);d.rotate(c.rotate*
c._toRad);d.translate(-c.x,-c.y);a&&(a.rotate+=c.rotate*c._toRad)}function za(d,c,a){1!==c.scale&&(c.scaleX=c.scaleY=c.scale);d.translate(c.x,c.y);d.scale(c.scaleX,c.scaleY);d.translate(-c.x,-c.y);a&&(a.scaleX*=c.scaleX,a.scaleY*=c.scaleY)}function Aa(d,c,a){c.translate&&(c.translateX=c.translateY=c.translate);d.translate(c.translateX,c.translateY);a&&(a.translateX+=c.translateX,a.translateY+=c.translateY)}function S(d,c,a,b,e){a._toRad=a.inDegrees?L/180:1;a._transformed=x;c.save();a.fromCenter||
a._centered||b===r||(e===r&&(e=b),a.x+=b/2,a.y+=e/2,a._centered=x);a.rotate&&ya(c,a,g);1===a.scale&&1===a.scaleX&&1===a.scaleY||za(c,a,g);(a.translate||a.translateX||a.translateY)&&Aa(c,a,g)}function D(d){var c=aa.dataCache,a;c._canvas===d&&c._data?a=c._data:(a=f.data(d,"jCanvas"),a||(a={canvas:d,layers:[],layer:{names:{},groups:{}},eventHooks:{},intersecting:[],lastIntersected:g,cursor:f(d).css("cursor"),drag:{layer:g,dragging:C},event:{type:g,x:g,y:g},events:{},transforms:la(na),savedTransforms:[],
animating:C,animated:g,pixelRatio:1,scaled:C},f.data(d,"jCanvas",a)),c._canvas=d,c._data=a);return a}function Ba(d,c,a){for(var b in O.events)O.events.hasOwnProperty(b)&&(a[b]||a.cursors&&a.cursors[b])&&Ca(d,c,a,b)}function Ca(d,c,a,b){window.ontouchstart!==r&&X.touchEvents[b]&&(b=X.touchEvents[b]);O.events[b](d,c);a._event=x}function Da(d,c,a){var b,e,h;if(a.draggable||a.cursors){b=["mousedown","mousemove","mouseup"];for(h=0;h<b.length;h+=1)e=b[h],Ca(d,c,a,e);c.events.mouseoutdrag||(d.bind("mouseout.jCanvas",
function(){var a=c.drag.layer;a&&(c.drag={},Q(d,c,a,"dragcancel"),d.drawLayers())}),c.events.mouseoutdrag=x);a._event=x}}function oa(d,c,a,b){d=c.layer.names;b?b.name!==r&&ka(a.name)&&a.name!==b.name&&delete d[a.name]:b=a;ka(b.name)&&(d[b.name]=a)}function pa(d,c,a,b){d=c.layer.groups;var e,h,k,f;if(!b)b=a;else if(b.groups!==r&&a.groups!==g)for(h=0;h<a.groups.length;h+=1)if(e=a.groups[h],c=d[e]){for(f=0;f<c.length;f+=1)if(c[f]===a){k=f;c.splice(f,1);break}0===c.length&&delete d[e]}if(b.groups!==r&&
b.groups!==g)for(h=0;h<b.groups.length;h+=1)e=b.groups[h],c=d[e],c||(c=d[e]=[],c.name=e),k===r&&(k=c.length),c.splice(k,0,a)}function qa(d,c,a,b,e){b[a]&&c._running&&!c._running[a]&&(c._running[a]=x,b[a].call(d[0],c,e),c._running[a]=C)}function Q(d,c,a,b,e){if(!a.disableEvents){var h;a.cursors&&(h=a.cursors[b]);-1!==f.inArray(h,Ea)&&(h=Fa.css+h);h&&d.css({cursor:h});qa(d,a,b,a,e);qa(d,a,b,c.eventHooks,e);qa(d,a,b,O.eventHooks,e)}}function P(d,c,a,b){var e=c._layer?a:c;c._args=a;c.canvas=d;if(c.draggable||
c.dragGroups)c.layer=x,c.draggable=x;c._method=b?b:c.method?f.fn[c.method]:c.type?f.fn[X.drawings[c.type]]:function(){};c.layer&&!c._layer&&(a=f(d),d=D(d),b=d.layers,e.name===g||ka(e.name)&&d.layer.names[e.name]===r)&&(e=new H(c),e.layer=x,e._layer=x,e._running={},e.data=e.data!==g?Y({},e.data):{},e.groups=e.groups!==g?e.groups.slice(0):[],oa(a,d,e),pa(a,d,e),Ba(a,d,e),Da(a,d,e),c._event=e._event,e._method===f.fn.drawText&&a.measureText(e),e.index===g&&(e.index=b.length),b.splice(e.index,0,e),c._args=
e,Q(a,d,e,"add"));return e}function Ga(d,c){var a,b;for(b=0;b<fa.length;b+=1)a=fa[b],d[a]!==r&&(d["_"+a]=d[a],ra[a]=x,c&&delete d[a])}function Va(d,c,a){var b,e,h,k;for(b in a)if(a.hasOwnProperty(b)&&(e=a[b],ba(e)&&(a[b]=e.call(d,c,b)),"object"===$(e))){for(h in e)e.hasOwnProperty(h)&&(k=e[h],c[b]!==r&&(c[b+"."+h]=c[b][h],a[b+"."+h]=k));delete a[b]}return a}function Ha(d){var c,a,b=[],e=1;d.match(/^([a-z]+|#[0-9a-f]+)$/gi)&&("transparent"===d&&(d="rgba(0,0,0,0)"),a=ta.head,c=a.style.color,a.style.color=
d,d=f.css(a,"color"),a.style.color=c);d.match(/^rgb/gi)&&(b=d.match(/(\d+(\.\d+)?)/gi),d.match(/%/gi)&&(e=2.55),b[0]*=e,b[1]*=e,b[2]*=e,b[3]=b[3]!==r?ja(b[3]):1);return b}function Wa(d){var c=3,a;"array"!==$(d.start)&&(d.start=Ha(d.start),d.end=Ha(d.end));d.now=[];if(1!==d.start[3]||1!==d.end[3])c=4;for(a=0;a<c;a+=1)d.now[a]=d.start[a]+(d.end[a]-d.start[a])*d.pos,3>a&&(d.now[a]=Xa(d.now[a]));1!==d.start[3]||1!==d.end[3]?d.now="rgba("+d.now.join(",")+")":(d.now.slice(0,3),d.now="rgb("+d.now.join(",")+
")");d.elem.nodeName?d.elem.style[d.prop]=d.now:d.elem[d.prop]=d.now}function Ya(d){O.events[d]=function(c,a){var b,e;e=a.event;b="mouseover"===d||"mouseout"===d?"mousemove":d;a.events[b]||(c.bind(b+".jCanvas",function(a){e.x=a.offsetX;e.y=a.offsetY;e.type=b;e.event=a;c.drawLayers({resetFire:x});a.preventDefault()}),a.events[b]=x)}}function U(d,c,a){var b,e,h,k;if(a=a._args)d=D(d),b=d.event,b.x!==g&&b.y!==g&&(h=b.x*d.pixelRatio,k=b.y*d.pixelRatio,e=c.isPointInPath(h,k)||c.isPointInStroke&&c.isPointInStroke(h,
k)),c=d.transforms,a.eventX=a.mouseX=b.x,a.eventY=a.mouseY=b.y,a.event=b.event,b=d.transforms.rotate,h=a.eventX,k=a.eventY,0!==b?(a._eventX=h*N(-b)-k*R(-b),a._eventY=k*N(-b)+h*R(-b)):(a._eventX=h,a._eventY=k),a._eventX/=c.scaleX,a._eventY/=c.scaleY,e&&d.intersecting.push(a),a.intersects=e}function Ia(d){for(;0>d;)d+=2*L;return d}function Ja(d,c,a,b){var e,h,k,f,A,t,g;a===b?g=t=0:(t=a.x,g=a.y);b.inDegrees||360!==b.end||(b.end=2*L);b.start*=a._toRad;b.end*=a._toRad;b.start-=L/2;b.end-=L/2;A=L/180*1;
b.ccw&&(A*=-1);e=b.x+b.radius*N(b.start+A);h=b.y+b.radius*R(b.start+A);k=b.x+b.radius*N(b.start);f=b.y+b.radius*R(b.start);ga(d,c,a,b,e,h,k,f);c.arc(b.x+t,b.y+g,b.radius,b.start,b.end,b.ccw);e=b.x+b.radius*N(b.end+A);A=b.y+b.radius*R(b.end+A);h=b.x+b.radius*N(b.end);k=b.y+b.radius*R(b.end);ha(d,c,a,b,h,k,e,A)}function Ka(d,c,a,b,e,h,k,f){var A,t;b.arrowRadius&&!a.closed&&(t=Za(f-h,k-e),t-=L,d=a.strokeWidth*N(t),A=a.strokeWidth*R(t),a=k+b.arrowRadius*N(t+b.arrowAngle/2),e=f+b.arrowRadius*R(t+b.arrowAngle/
2),h=k+b.arrowRadius*N(t-b.arrowAngle/2),b=f+b.arrowRadius*R(t-b.arrowAngle/2),c.moveTo(a-d,e-A),c.lineTo(k-d,f-A),c.lineTo(h-d,b-A),c.moveTo(k-d,f-A),c.lineTo(k+d,f+A),c.moveTo(k,f))}function ga(d,c,a,b,e,h,k,f){b._arrowAngleConverted||(b.arrowAngle*=a._toRad,b._arrowAngleConverted=x);b.startArrow&&Ka(d,c,a,b,e,h,k,f)}function ha(d,c,a,b,e,h,k,f){b._arrowAngleConverted||(b.arrowAngle*=a._toRad,b._arrowAngleConverted=x);b.endArrow&&Ka(d,c,a,b,e,h,k,f)}function La(d,c,a,b){var e,h,k;e=2;ga(d,c,a,b,
b.x2+a.x,b.y2+a.y,b.x1+a.x,b.y1+a.y);for(b.x1!==r&&b.y1!==r&&c.moveTo(b.x1+a.x,b.y1+a.y);x;)if(h=b["x"+e],k=b["y"+e],h!==r&&k!==r)c.lineTo(h+a.x,k+a.y),e+=1;else break;e-=1;ha(d,c,a,b,b["x"+(e-1)]+a.x,b["y"+(e-1)]+a.y,b["x"+e]+a.x,b["y"+e]+a.y)}function Ma(d,c,a,b){var e,h,k,f,A;e=2;ga(d,c,a,b,b.cx1+a.x,b.cy1+a.y,b.x1+a.x,b.y1+a.y);for(b.x1!==r&&b.y1!==r&&c.moveTo(b.x1+a.x,b.y1+a.y);x;)if(h=b["x"+e],k=b["y"+e],f=b["cx"+(e-1)],A=b["cy"+(e-1)],h!==r&&k!==r&&f!==r&&A!==r)c.quadraticCurveTo(f+a.x,A+a.y,
h+a.x,k+a.y),e+=1;else break;e-=1;ha(d,c,a,b,b["cx"+(e-1)]+a.x,b["cy"+(e-1)]+a.y,b["x"+e]+a.x,b["y"+e]+a.y)}function Na(d,c,a,b){var e,h,k,f,A,t,g,F;e=2;h=1;ga(d,c,a,b,b.cx1+a.x,b.cy1+a.y,a.x1+a.x,a.y1+a.y);for(a.x1!==r&&a.y1!==r&&c.moveTo(a.x1+a.x,a.y1+a.y);x;)if(k=b["x"+e],f=b["y"+e],A=b["cx"+h],t=b["cy"+h],g=b["cx"+(h+1)],F=b["cy"+(h+1)],k!==r&&f!==r&&A!==r&&t!==r&&g!==r&&F!==r)c.bezierCurveTo(A+a.x,t+a.y,g+a.x,F+a.y,k+a.x,f+a.y),e+=1,h+=2;else break;e-=1;h-=2;ha(d,c,a,b,b["cx"+(h+1)]+a.x,b["cy"+
(h+1)]+a.y,b["x"+e]+a.x,b["y"+e]+a.y)}function Oa(d,c,a){c*=d._toRad;c-=L/2;return a*N(c)}function Pa(d,c,a){c*=d._toRad;c-=L/2;return a*R(c)}function Qa(d,c,a,b){var e,h,k,f,g,t,E;a===b?g=f=0:(f=a.x,g=a.y);e=1;h=f=t=b.x+f;k=g=E=b.y+g;ga(d,c,a,b,h+Oa(a,b.a1,b.l1),k+Pa(a,b.a1,b.l1),h,k);for(b.x!==r&&b.y!==r&&c.moveTo(h,k);x;)if(h=b["a"+e],k=b["l"+e],h!==r&&k!==r)f=t,g=E,t+=Oa(a,h,k),E+=Pa(a,h,k),c.lineTo(t,E),e+=1;else break;ha(d,c,a,b,f,g,t,E)}function Ra(d,c){isNaN(Number(c.fontSize))||(c.fontSize+=
"px");d.font=c.fontStyle+" "+c.fontSize+" "+c.fontFamily}function Sa(d,c,a,b){var e,h;e=aa.propCache;if(e.text===a.text&&e.fontStyle===a.fontStyle&&e.fontSize===a.fontSize&&e.fontFamily===a.fontFamily&&e.maxWidth===a.maxWidth&&e.lineHeight===a.lineHeight)a.width=e.width,a.height=e.height;else{a.width=c.measureText(b[0]).width;for(h=1;h<b.length;h+=1)e=c.measureText(b[h]).width,e>a.width&&(a.width=e);c=d.style.fontSize;d.style.fontSize=a.fontSize;a.height=ja(f.css(d,"fontSize"))*b.length*a.lineHeight;
d.style.fontSize=c}}function Ta(d,c){var a=c.maxWidth,b=c.text.split("\n"),e=[],h,k,f,g,t;for(f=0;f<b.length;f+=1){g=b[f];t=g.split(" ");h=[];k="";if(1===t.length||d.measureText(g).width<a)h=[g];else{for(g=0;g<t.length;g+=1)d.measureText(k+t[g]).width>a&&(""!==k&&h.push(k),k=""),k+=t[g],g!==t.length-1&&(k+=" ");h.push(k)}e=e.concat(h.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n"))}return e}var ma,Z,Y=f.extend,ia=f.inArray,$=f.type,ba=f.isFunction,L=da.PI,Xa=da.round,R=da.sin,N=da.cos,Za=da.atan2,
sa=Ua.prototype.slice,$a=f.event.fix,X={},aa={dataCache:{},propCache:{},imageCache:{}},na={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},fa,ra,Ea,Fa;f.fn.jCanvas=O;O.events={};O.eventHooks={};O.future={inheritance:!1};ma=new function(){Y(this,{align:"center",arrowAngle:90,arrowRadius:0,autosave:x,baseline:"middle",bringToFront:C,ccw:C,closed:C,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:x,cursors:g,disableEvents:C,draggable:C,dragGroups:g,groups:g,
data:g,dx:g,dy:g,end:360,eventX:g,eventY:g,fillStyle:"transparent",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:x,height:g,imageSmoothing:x,inDegrees:x,index:g,lineHeight:1,layer:C,mask:C,maxWidth:g,miterLimit:10,name:g,opacity:1,r1:g,r2:g,radius:0,repeat:"repeat",respectAlign:C,rotate:0,rounded:C,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowStroke:C,shadowX:0,shadowY:0,sHeight:g,sides:0,source:"",spread:0,start:0,strokeCap:"butt",strokeJoin:"miter",
strokeStyle:"transparent",strokeWidth:1,sWidth:g,sx:g,sy:g,text:"",translate:0,translateX:0,translateY:0,type:g,visible:x,width:g,x:0,y:0})};va.prototype=ma;Z=new va;H.prototype=Z;O.extend=function(d){d.name&&(d.props&&Y(ma,d.props),f.fn[d.name]=function a(b){var e,h,k,f;for(h=0;h<this.length;h+=1)if(e=this[h],k=J(e))f=new H(b),P(e,f,b,a),T(e,k,f),d.fn.call(e,k,f);return this},d.type&&(X.drawings[d.type]=d.name));return f.fn[d.name]};f.fn.getEventHooks=function(){var d;d={};0!==this.length&&(d=this[0],
d=D(d),d=d.eventHooks);return d};f.fn.setEventHooks=function(d){var c,a;for(c=0;c<this.length;c+=1)f(this[c]),a=D(this[c]),Y(a.eventHooks,d);return this};f.fn.getLayers=function(d){var c,a,b,e,h=[];if(0!==this.length)if(c=this[0],a=D(c),a=a.layers,ba(d))for(e=0;e<a.length;e+=1)b=a[e],d.call(c,b)&&h.push(b);else h=a;return h};f.fn.getLayer=function(d){var c,a,b,e;if(0!==this.length)if(c=this[0],a=D(c),c=a.layers,e=$(d),d&&d.layer)b=d;else if("number"===e)0>d&&(d=c.length+d),b=c[d];else if("regexp"===
e)for(a=0;a<c.length;a+=1){if(ka(c[a].name)&&c[a].name.match(d)){b=c[a];break}}else b=a.layer.names[d];return b};f.fn.getLayerGroup=function(d){var c,a,b,e=$(d);if(0!==this.length)if(c=this[0],"array"===e)b=d;else if("regexp"===e)for(a in c=D(c),c=c.layer.groups,c){if(a.match(d)){b=c[a];break}}else c=D(c),b=c.layer.groups[d];return b};f.fn.getLayerIndex=function(d){var c=this.getLayers();d=this.getLayer(d);return ia(d,c)};f.fn.setLayer=function(d,c){var a,b,e,h,k,g,A;for(b=0;b<this.length;b+=1)if(a=
f(this[b]),e=D(this[b]),h=f(this[b]).getLayer(d)){oa(a,e,h,c);pa(a,e,h,c);for(k in c)c.hasOwnProperty(k)&&(g=c[k],A=$(g),"object"===A?h[k]=Y({},g):"array"===A?h[k]=g.slice(0):"string"===A?0===g.indexOf("+=")?h[k]+=ja(g.substr(2)):0===g.indexOf("-=")?h[k]-=ja(g.substr(2)):h[k]=g:h[k]=g);Ba(a,e,h);Da(a,e,h);f.isEmptyObject(c)===C&&Q(a,e,h,"change",c)}return this};f.fn.setLayers=function(d,c){var a,b,e,h;for(b=0;b<this.length;b+=1)for(a=f(this[b]),e=a.getLayers(c),h=0;h<e.length;h+=1)a.setLayer(e[h],
d);return this};f.fn.setLayerGroup=function(d,c){var a,b,e,h;for(b=0;b<this.length;b+=1)if(a=f(this[b]),e=a.getLayerGroup(d))for(h=0;h<e.length;h+=1)a.setLayer(e[h],c);return this};f.fn.moveLayer=function(d,c){var a,b,e,h,k;for(b=0;b<this.length;b+=1)if(a=f(this[b]),e=D(this[b]),h=e.layers,k=a.getLayer(d))k.index=ia(k,h),h.splice(k.index,1),h.splice(c,0,k),0>c&&(c=h.length+c),k.index=c,Q(a,e,k,"move");return this};f.fn.removeLayer=function(d){var c,a,b,e,h;for(a=0;a<this.length;a+=1)if(c=f(this[a]),
b=D(this[a]),e=c.getLayers(),h=c.getLayer(d))h.index=ia(h,e),e.splice(h.index,1),oa(c,b,h,{name:g}),pa(c,b,h,{groups:g}),Q(c,b,h,"remove");return this};f.fn.removeLayers=function(d){var c,a,b,e,h,k;for(a=0;a<this.length;a+=1){c=f(this[a]);b=D(this[a]);e=c.getLayers(d);for(k=0;k<e.length;k+=1)h=e[k],c.removeLayer(h),k-=1;b.layer.names={};b.layer.groups={}}return this};f.fn.removeLayerGroup=function(d){var c,a,b,e;if(d!==r)for(a=0;a<this.length;a+=1)if(c=f(this[a]),D(this[a]),c.getLayers(),b=c.getLayerGroup(d))for(b=
b.slice(0),e=0;e<b.length;e+=1)c.removeLayer(b[e]);return this};f.fn.addLayerToGroup=function(d,c){var a,b,e,h=[c];for(b=0;b<this.length;b+=1)a=f(this[b]),e=a.getLayer(d),e.groups&&(h=e.groups.slice(0),-1===ia(c,e.groups)&&h.push(c)),a.setLayer(e,{groups:h});return this};f.fn.removeLayerFromGroup=function(d,c){var a,b,e,h=[],k;for(b=0;b<this.length;b+=1)a=f(this[b]),e=a.getLayer(d),e.groups&&(k=ia(c,e.groups),-1!==k&&(h=e.groups.slice(0),h.splice(k,1),a.setLayer(e,{groups:h})));return this};Ea=["grab",
"grabbing","zoom-in","zoom-out"];Fa=function(){var d=getComputedStyle(ta.documentElement,""),d=(sa.call(d).join("").match(/-(moz|webkit|ms)-/)||""===d.OLink&&["","o"])[1];return{lowercase:d,css:"-"+d+"-",js:d[0].toUpperCase()+d.substr(1)}}();f.fn.triggerLayerEvent=function(d,c){var a,b,e;for(b=0;b<this.length;b+=1)a=f(this[b]),e=D(this[b]),(d=a.getLayer(d))&&Q(a,e,d,c);return this};f.fn.drawLayer=function(d){var c,a,b;for(c=0;c<this.length;c+=1)a=f(this[c]),J(this[c]),(b=a.getLayer(d))&&b.visible&&
b._method&&(b._next=g,b._method.call(a,b));return this};f.fn.drawLayers=function(d){var c,a,b=Y({},d),e,h,k,K,A,t;b.index||(b.index=0);for(c=0;c<this.length;c+=1)if(d=f(this[c]),a=J(this[c])){K=D(this[c]);b.clear!==C&&d.clearCanvas();a=K.layers;for(k=b.index;k<a.length&&(e=a[k],e.index=k,b.resetFire&&(e._fired=C),A=d,t=e,h=k+1,t&&t.visible&&t._method&&(t._next=h?h:g,t._method.call(A,t)),e._masks=K.transforms.masks.slice(0),e._method!==f.fn.drawImage||!e.visible);k+=1);e=K;var E=h=t=A=void 0;A=g;for(t=
e.intersecting.length-1;0<=t;t-=1)if(A=e.intersecting[t],A._masks){for(E=A._masks.length-1;0<=E;E-=1)if(h=A._masks[E],!h.intersects){A.intersects=C;break}if(A.intersects)break}e=A;A=K.event;t=A.type;if(K.drag.layer){h=d;var E=K,F=t,y=void 0,v=void 0,p=void 0,B=p=void 0,m=void 0,p=y=y=p=void 0,p=E.drag,B=(v=p.layer)&&v.dragGroups||[],y=E.layers;if("mousemove"===F||"touchmove"===F){if(p.dragging||(p.dragging=x,v.dragging=x,v.bringToFront&&(y.splice(v.index,1),v.index=y.push(v)),v._startX=v.x,v._startY=
v.y,v._endX=v._eventX,v._endY=v._eventY,Q(h,E,v,"dragstart")),p.dragging)for(y=v._eventX-(v._endX-v._startX),p=v._eventY-(v._endY-v._startY),v.dx=y-v.x,v.dy=p-v.y,v.x=y,v.y=p,Q(h,E,v,"drag"),y=0;y<B.length;y+=1)if(p=B[y],m=E.layer.groups[p],v.groups&&m)for(p=0;p<m.length;p+=1)m[p]!==v&&(m[p].x+=v.dx,m[p].y+=v.dy)}else if("mouseup"===F||"touchend"===F)p.dragging&&(v.dragging=C,p.dragging=C,Q(h,E,v,"dragstop")),E.drag={}}h=K.lastIntersected;h===g||e===h||!h._hovered||h._fired||K.drag.dragging||(K.lastIntersected=
g,h._fired=x,h._hovered=C,Q(d,K,h,"mouseout"),d.css({cursor:K.cursor}));e&&(e[t]||X.mouseEvents[t]&&(t=X.mouseEvents[t]),e._event&&e.intersects&&(K.lastIntersected=e,!(e.mouseover||e.mouseout||e.cursors)||K.drag.dragging||e._hovered||e._fired||(e._fired=x,e._hovered=x,Q(d,K,e,"mouseover")),e._fired||(e._fired=x,A.type=g,Q(d,K,e,t)),!e.draggable||e.disableEvents||"mousedown"!==t&&"touchstart"!==t||(K.drag.layer=e)));e!==g||K.drag.dragging||d.css({cursor:K.cursor});k===a.length&&(K.intersecting.length=
0,K.transforms=la(na),K.savedTransforms.length=0)}return this};f.fn.addLayer=function(d){var c,a;for(c=0;c<this.length;c+=1)if(a=J(this[c]))a=new H(d),a.layer=x,P(this[c],a,d);return this};fa=["width","height","opacity","lineHeight"];ra={};f.fn.animateLayer=function(){function d(a,b,c){return function(){var d,e;for(e=0;e<fa.length;e+=1)d=fa[e],c[d]=c["_"+d];for(var k in c)c.hasOwnProperty(k)&&-1!==k.indexOf(".")&&delete c[k];b.animating&&b.animated!==c||a.drawLayers();c._animating=C;b.animating=C;
b.animated=g;h[4]&&h[4].call(a[0],c);Q(a,b,c,"animateend")}}function c(a,b,c){return function(d,e){var k,f,g=!1;"_"===e.prop[0]&&(g=!0,e.prop=e.prop.replace("_",""),c[e.prop]=c["_"+e.prop]);-1!==e.prop.indexOf(".")&&(k=e.prop.split("."),f=k[0],k=k[1],c[f]&&(c[f][k]=e.now));c._pos!==e.pos&&(c._pos=e.pos,c._animating||b.animating||(c._animating=x,b.animating=x,b.animated=c),b.animating&&b.animated!==c||a.drawLayers());h[5]&&h[5].call(a[0],d,e,c);Q(a,b,c,"animate",e);g&&(e.prop="_"+e.prop)}}var a,b,
e,h=sa.call(arguments,0),k,K;"object"===$(h[2])?(h.splice(2,0,h[2].duration||g),h.splice(3,0,h[3].easing||g),h.splice(4,0,h[4].complete||g),h.splice(5,0,h[5].step||g)):(h[2]===r?(h.splice(2,0,g),h.splice(3,0,g),h.splice(4,0,g)):ba(h[2])&&(h.splice(2,0,g),h.splice(3,0,g)),h[3]===r?(h[3]=g,h.splice(4,0,g)):ba(h[3])&&h.splice(3,0,g));for(b=0;b<this.length;b+=1)if(a=f(this[b]),e=J(this[b]))e=D(this[b]),(k=a.getLayer(h[0]))&&k._method!==f.fn.draw&&(K=Y({},h[1]),K=Va(this[b],k,K),Ga(K,x),Ga(k),k.style=
ra,f(k).animate(K,{duration:h[2],easing:f.easing[h[3]]?h[3]:g,complete:d(a,e,k),step:c(a,e,k)}),Q(a,e,k,"animatestart"));return this};f.fn.animateLayerGroup=function(d){var c,a,b=sa.call(arguments,0),e,h;for(a=0;a<this.length;a+=1)if(c=f(this[a]),e=c.getLayerGroup(d))for(h=0;h<e.length;h+=1)b[0]=e[h],c.animateLayer.apply(c,b);return this};f.fn.delayLayer=function(d,c){var a,b,e,h;c=c||0;for(b=0;b<this.length;b+=1)if(a=f(this[b]),e=D(this[b]),h=a.getLayer(d))f(h).delay(c),Q(a,e,h,"delay");return this};
f.fn.delayLayerGroup=function(d,c){var a,b,e,h,k;c=c||0;for(b=0;b<this.length;b+=1)if(a=f(this[b]),e=a.getLayerGroup(d))for(k=0;k<e.length;k+=1)h=e[k],a.delayLayer(h,c);return this};f.fn.stopLayer=function(d,c){var a,b,e,h;for(b=0;b<this.length;b+=1)if(a=f(this[b]),e=D(this[b]),h=a.getLayer(d))f(h).stop(c),Q(a,e,h,"stop");return this};f.fn.stopLayerGroup=function(d,c){var a,b,e,h,k;for(b=0;b<this.length;b+=1)if(a=f(this[b]),e=a.getLayerGroup(d))for(k=0;k<e.length;k+=1)h=e[k],a.stopLayer(h,c);return this};
(function(d){var c;for(c=0;c<d.length;c+=1)f.fx.step[d[c]]=Wa})("color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "));X.touchEvents={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"};X.mouseEvents={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"};(function(d){var c;for(c=0;c<d.length;c+=1)Ya(d[c])})("click dblclick mousedown mouseup mousemove mouseover mouseout touchstart touchmove touchend".split(" "));
f.event.fix=function(d){var c,a;d=$a.call(f.event,d);if(c=d.originalEvent)if(a=c.changedTouches,d.pageX!==r&&d.offsetX===r){if(c=f(d.currentTarget).offset())d.offsetX=d.pageX-c.left,d.offsetY=d.pageY-c.top}else a&&(c=f(d.currentTarget).offset())&&(d.offsetX=a[0].pageX-c.left,d.offsetY=a[0].pageY-c.top);return d};X.drawings={arc:"drawArc",bezier:"drawBezier",ellipse:"drawEllipse","function":"draw",image:"drawImage",line:"drawLine",path:"drawPath",polygon:"drawPolygon",slice:"drawSlice",quadratic:"drawQuadratic",
rectangle:"drawRect",text:"drawText",vector:"drawVector"};f.fn.draw=function c(a){var b,e,h=new H(a);if(X.drawings[h.type])this[X.drawings[h.type]](a);else for(b=0;b<this.length;b+=1)if(f(this[b]),e=J(this[b]))h=new H(a),P(this[b],h,a,c),h.visible&&h.fn&&h.fn.call(this[b],e,h);return this};f.fn.clearCanvas=function a(b){var e,h,k=new H(b);for(e=0;e<this.length;e+=1)if(h=J(this[e]))k.width===g||k.height===g?(h.save(),h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,this[e].width,this[e].height),h.restore()):
(P(this[e],k,b,a),S(this[e],h,k,k.width,k.height),h.clearRect(k.x-k.width/2,k.y-k.height/2,k.width,k.height),k._transformed&&h.restore());return this};f.fn.saveCanvas=function b(e){var h,k,f,g,t;for(h=0;h<this.length;h+=1)if(k=J(this[h]))for(g=D(this[h]),f=new H(e),P(this[h],f,e,b),t=0;t<f.count;t+=1)ea(k,g);return this};f.fn.restoreCanvas=function e(h){var k,f,g,t,E;for(k=0;k<this.length;k+=1)if(f=J(this[k]))for(t=D(this[k]),g=new H(h),P(this[k],g,h,e),E=0;E<g.count;E+=1){var F=f,y=t;0===y.savedTransforms.length?
y.transforms=la(na):(F.restore(),y.transforms=y.savedTransforms.pop())}return this};f.fn.rotateCanvas=function h(f){var g,A,t,E;for(g=0;g<this.length;g+=1)if(A=J(this[g]))E=D(this[g]),t=new H(f),P(this[g],t,f,h),t.autosave&&ea(A,E),ya(A,t,E.transforms);return this};f.fn.scaleCanvas=function k(f){var g,t,E,F;for(g=0;g<this.length;g+=1)if(t=J(this[g]))F=D(this[g]),E=new H(f),P(this[g],E,f,k),E.autosave&&ea(t,F),za(t,E,F.transforms);return this};f.fn.translateCanvas=function K(f){var g,E,F,y;for(g=0;g<
this.length;g+=1)if(E=J(this[g]))y=D(this[g]),F=new H(f),P(this[g],F,f,K),F.autosave&&ea(E,y),Aa(E,F,y.transforms);return this};f.fn.drawRect=function A(f){var g,F,y,v,p,B,m,z;for(g=0;g<this.length;g+=1)if(F=J(this[g]))y=new H(f),P(this[g],y,f,A),y.visible&&(T(this[g],F,y),S(this[g],F,y,y.width,y.height),F.beginPath(),v=y.x-y.width/2,p=y.y-y.height/2,(z=y.cornerRadius)?(B=y.x+y.width/2,m=y.y+y.height/2,0>B-v-2*z&&(z=(B-v)/2),0>m-p-2*z&&(z=(m-p)/2),F.moveTo(v+z,p),F.lineTo(B-z,p),F.arc(B-z,p+z,z,3*
L/2,2*L,C),F.lineTo(B,m-z),F.arc(B-z,m-z,z,0,L/2,C),F.lineTo(v+z,m),F.arc(v+z,m-z,z,L/2,L,C),F.lineTo(v,p+z),F.arc(v+z,p+z,z,L,3*L/2,C),y.closed=x):F.rect(v,p,y.width,y.height),U(this[g],F,y),W(this[g],F,y));return this};f.fn.drawArc=function t(f){var g,y,v;for(g=0;g<this.length;g+=1)if(y=J(this[g]))v=new H(f),P(this[g],v,f,t),v.visible&&(T(this[g],y,v),S(this[g],y,v,2*v.radius),y.beginPath(),Ja(this[g],y,v,v),U(this[g],y,v),W(this[g],y,v));return this};f.fn.drawEllipse=function E(f){var g,v,p,B,
m;for(g=0;g<this.length;g+=1)if(v=J(this[g]))p=new H(f),P(this[g],p,f,E),p.visible&&(T(this[g],v,p),S(this[g],v,p,p.width,p.height),B=4/3*p.width,m=p.height,v.beginPath(),v.moveTo(p.x,p.y-m/2),v.bezierCurveTo(p.x-B/2,p.y-m/2,p.x-B/2,p.y+m/2,p.x,p.y+m/2),v.bezierCurveTo(p.x+B/2,p.y+m/2,p.x+B/2,p.y-m/2,p.x,p.y-m/2),U(this[g],v,p),p.closed=x,W(this[g],v,p));return this};f.fn.drawPolygon=function F(g){var f,p,B,m,z,M,G,w,n,l;for(f=0;f<this.length;f+=1)if(p=J(this[f]))if(B=new H(g),P(this[f],B,g,F),B.visible){T(this[f],
p,B);S(this[f],p,B,2*B.radius);z=2*L/B.sides;M=z/2;m=M+L/2;G=B.radius*N(M);p.beginPath();for(l=0;l<B.sides;l+=1)w=B.x+B.radius*N(m),n=B.y+B.radius*R(m),p.lineTo(w,n),B.concavity&&(w=B.x+(G+-G*B.concavity)*N(m+M),n=B.y+(G+-G*B.concavity)*R(m+M),p.lineTo(w,n)),m+=z;U(this[f],p,B);B.closed=x;W(this[f],p,B)}return this};f.fn.drawSlice=function y(g){var p,B,m,z,M;for(p=0;p<this.length;p+=1)if(f(this[p]),B=J(this[p]))m=new H(g),P(this[p],m,g,y),m.visible&&(T(this[p],B,m),S(this[p],B,m,2*m.radius),m.start*=
m._toRad,m.end*=m._toRad,m.start-=L/2,m.end-=L/2,m.start=Ia(m.start),m.end=Ia(m.end),m.end<m.start&&(m.end+=2*L),z=(m.start+m.end)/2,M=m.radius*m.spread*N(z),z=m.radius*m.spread*R(z),m.x+=M,m.y+=z,B.beginPath(),B.arc(m.x,m.y,m.radius,m.start,m.end,m.ccw),B.lineTo(m.x,m.y),U(this[p],B,m),m.closed=x,W(this[p],B,m));return this};f.fn.drawLine=function v(f){var g,m,z;for(g=0;g<this.length;g+=1)if(m=J(this[g]))z=new H(f),P(this[g],z,f,v),z.visible&&(T(this[g],m,z),S(this[g],m,z),m.beginPath(),La(this[g],
m,z,z),U(this[g],m,z),W(this[g],m,z));return this};f.fn.drawQuadratic=function p(g){var f,z,M;for(f=0;f<this.length;f+=1)if(z=J(this[f]))M=new H(g),P(this[f],M,g,p),M.visible&&(T(this[f],z,M),S(this[f],z,M),z.beginPath(),Ma(this[f],z,M,M),U(this[f],z,M),W(this[f],z,M));return this};f.fn.drawBezier=function B(f){var g,M,G;for(g=0;g<this.length;g+=1)if(M=J(this[g]))G=new H(f),P(this[g],G,f,B),G.visible&&(T(this[g],M,G),S(this[g],M,G),M.beginPath(),Na(this[g],M,G,G),U(this[g],M,G),W(this[g],M,G));return this};
f.fn.drawVector=function m(g){var f,G,w;for(f=0;f<this.length;f+=1)if(G=J(this[f]))w=new H(g),P(this[f],w,g,m),w.visible&&(T(this[f],G,w),S(this[f],G,w),G.beginPath(),Qa(this[f],G,w,w),U(this[f],G,w),W(this[f],G,w));return this};f.fn.drawPath=function z(f){var g,w,n,l,u;for(g=0;g<this.length;g+=1)if(w=J(this[g]))if(n=new H(f),P(this[g],n,f,z),n.visible){T(this[g],w,n);S(this[g],w,n);w.beginPath();for(l=1;x;)if(u=n["p"+l],u!==r)u=new H(u),"line"===u.type?La(this[g],w,n,u):"quadratic"===u.type?Ma(this[g],
w,n,u):"bezier"===u.type?Na(this[g],w,n,u):"vector"===u.type?Qa(this[g],w,n,u):"arc"===u.type&&Ja(this[g],w,n,u),l+=1;else break;U(this[g],w,n);W(this[g],w,n)}return this};f.fn.drawText=function M(G){var w,n,l,u,V,s,r;for(w=0;w<this.length;w+=1)if(f(this[w]),n=J(this[w]))if(l=new H(G),u=P(this[w],l,G,M),l.visible){T(this[w],n,l);n.textBaseline=l.baseline;n.textAlign=l.align;Ra(n,l);V=l.maxWidth!==g?Ta(n,l):l.text.toString().split("\n");Sa(this[w],n,l,V);u&&(u.width=l.width,u.height=l.height);S(this[w],
n,l,l.width,l.height);s=l.x;"left"===l.align?l.respectAlign?l.x+=l.width/2:s-=l.width/2:"right"===l.align&&(l.respectAlign?l.x-=l.width/2:s+=l.width/2);for(u=0;u<V.length;u+=1)n.shadowColor=l.shadowColor,r=l.y+u*l.height/V.length-(V.length-1)*l.height/V.length/2,n.fillText(V[u],s,r),"transparent"!==l.fillStyle&&(n.shadowColor="transparent"),n.strokeText(V[u],s,r);l._event&&(n.beginPath(),n.rect(l.x-l.width/2,l.y-l.height/2,l.width,l.height),U(this[w],n,l),n.closePath());l._transformed&&n.restore()}aa.propCache=
l;return this};f.fn.measureText=function(g){var f,w;f=this.getLayer(g);if(!f||f&&!f._layer)f=new H(g);if(g=J(this[0]))Ra(g,f),w=Ta(g,f),Sa(this[0],g,f,w);return f};f.fn.drawImage=function G(w){function n(l,n,s,q,w){return function(){var u=f(l);T(l,n,q);q.width===g&&q.sWidth===g&&(q.width=q.sWidth=I.width);q.height===g&&q.sHeight===g&&(q.height=q.sHeight=I.height);w&&(w.width=q.width,w.height=q.height);q.sWidth!==g&&q.sHeight!==g&&q.sx!==g&&q.sy!==g?(q.width===g&&(q.width=q.sWidth),q.height===g&&(q.height=
q.sHeight),q.cropFromCenter||(q.sx+=q.sWidth/2,q.sy+=q.sHeight/2),0>q.sy-q.sHeight/2&&(q.sy=q.sHeight/2),q.sy+q.sHeight/2>I.height&&(q.sy=I.height-q.sHeight/2),0>q.sx-q.sWidth/2&&(q.sx=q.sWidth/2),q.sx+q.sWidth/2>I.width&&(q.sx=I.width-q.sWidth/2),S(l,n,q,q.width,q.height),n.drawImage(I,q.sx-q.sWidth/2,q.sy-q.sHeight/2,q.sWidth,q.sHeight,q.x-q.width/2,q.y-q.height/2,q.width,q.height)):(S(l,n,q,q.width,q.height),n.drawImage(I,q.x-q.width/2,q.y-q.height/2,q.width,q.height));n.beginPath();n.rect(q.x-
q.width/2,q.y-q.height/2,q.width,q.height);U(l,n,q);n.closePath();q._transformed&&n.restore();xa(n,s,q);q.layer?Q(u,s,w,"load"):q.load&&q.load.call(u[0],w);q.layer&&(w._masks=s.transforms.masks.slice(0),q._next&&u.drawLayers({clear:C,resetFire:x,index:q._next}))}}var l,u,V,s,ca,L,I,O,N,R=aa.imageCache;for(u=0;u<this.length;u+=1)if(l=this[u],V=J(this[u]))s=D(this[u]),ca=new H(w),L=P(this[u],ca,w,G),ca.visible&&(N=ca.source,O=N.getContext,N.src||O?I=N:N&&(R[N]!==r?I=R[N]:(I=new ua,I.src=N,R[N]=I)),
I&&(I.complete||O?n(l,V,s,ca,L)():(f(I).bind("load",n(l,V,s,ca,L)),I.src=I.src)));return this};f.fn.createPattern=function(G){function w(){s=l.createPattern(r,u.repeat);u.load&&u.load.call(n[0],s)}var n=this,l,u,r,s,x;(l=J(n[0]))?(u=new H(G),x=u.source,ba(x)?(r=f("<canvas />")[0],r.width=u.width,r.height=u.height,G=J(r),x.call(r,G),w()):(G=x.getContext,x.src||G?r=x:(r=new ua,r.src=x),r.complete||G?w():(f(r).bind("load",w),r.src=r.src))):s=g;return s};f.fn.createGradient=function(f){var w,n=[],l,u,
x,s,C,D,I;f=new H(f);if(w=J(this[0])){f.x1=f.x1||0;f.y1=f.y1||0;f.x2=f.x2||0;f.y2=f.y2||0;w=f.r1!==g&&f.r2!==g?w.createRadialGradient(f.x1,f.y1,f.r1,f.x2,f.y2,f.r2):w.createLinearGradient(f.x1,f.y1,f.x2,f.y2);for(s=1;f["c"+s]!==r;s+=1)f["s"+s]!==r?n.push(f["s"+s]):n.push(g);l=n.length;n[0]===g&&(n[0]=0);n[l-1]===g&&(n[l-1]=1);for(s=0;s<l;s+=1){if(n[s]!==g){D=1;I=0;u=n[s];for(C=s+1;C<l;C+=1)if(n[C]!==g){x=n[C];break}else D+=1;u>x&&(n[C]=n[s])}else n[s]===g&&(I+=1,n[s]=u+(x-u)/D*I);w.addColorStop(n[s],
f["c"+(s+1)])}}else w=g;return w};f.fn.setPixels=function w(f){var l,u,r,s,x,C,I,D,L;for(u=0;u<this.length;u+=1)if(l=this[u],r=J(l)){s=new H(f);P(l,s,f,w);S(this[u],r,s,s.width,s.height);if(s.width===g||s.height===g)s.width=l.width,s.height=l.height,s.x=s.width/2,s.y=s.height/2;if(0!==s.width&&0!==s.height){C=r.getImageData(s.x-s.width/2,s.y-s.height/2,s.width,s.height);I=C.data;L=I.length;if(s.each)for(D=0;D<L;D+=4)x={r:I[D],g:I[D+1],b:I[D+2],a:I[D+3]},s.each.call(l,x,s),I[D]=x.r,I[D+1]=x.g,I[D+
2]=x.b,I[D+3]=x.a;r.putImageData(C,s.x-s.width/2,s.y-s.height/2);r.restore()}}return this};f.fn.getCanvasImage=function(f,n){var l,u=g;0!==this.length&&(l=this[0],l.toDataURL&&(n===r&&(n=1),u=l.toDataURL("image/"+f,n)));return u};f.fn.detectPixelRatio=function(g){var n,l,u,r,s,C,H;for(l=0;l<this.length;l+=1)n=this[l],f(this[l]),u=J(n),H=D(this[l]),H.scaled||(r=window.devicePixelRatio||1,s=u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||u.oBackingStorePixelRatio||
u.backingStorePixelRatio||1,r/=s,1!==r&&(s=n.width,C=n.height,n.width=s*r,n.height=C*r,n.style.width=s+"px",n.style.height=C+"px",u.scale(r,r)),H.pixelRatio=r,H.scaled=x,g&&g.call(n,r));return this};O.clearCache=function(){for(var f in aa)aa.hasOwnProperty(f)&&(aa[f]={})};f.support.canvas=f("<canvas />")[0].getContext!==r;O.defaults=ma;O.prefs=Z;O.setGlobalProps=T;O.transformShape=S;O.detectEvents=U;O.closePath=W;f.jCanvas=O})(jQuery,document,Image,Array,Math,parseFloat,!0,!1,null);
