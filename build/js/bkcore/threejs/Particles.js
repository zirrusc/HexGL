var bkcore=bkcore||{};bkcore.threejs=bkcore.threejs||{},bkcore.threejs.Particles=function(a){this.black=new THREE.Color(0),this.white=new THREE.Color(16777215),this.material=new THREE.ParticleBasicMaterial({color:void 0==a.tint?16777215:a.tint,map:void 0==a.texture?null:a.texture,size:void 0==a.size?4:a.size,blending:void 0==a.blending?THREE.AdditiveBlending:a.blending,depthTest:void 0==a.depthTest?!1:a.depthTest,transparent:void 0==a.transparent?!0:a.transparent,vertexColors:!0,opacity:void 0==a.opacity?1:a.opacity,sizeAttenuation:!0}),this.max=void 0==a.max?1e3:a.max,this.spawnRate=void 0==a.spawnRate?0:a.spawnRate,this.spawn=void 0==a.spawn?new THREE.Vector3:a.spawn,this.velocity=void 0==a.velocity?new THREE.Vector3:a.velocity,this.randomness=void 0==a.randomness?new THREE.Vector3:a.randomness,this.force=void 0==a.force?new THREE.Vector3:a.force,this.spawnRadius=void 0==a.spawnRadius?new THREE.Vector3:a.spawnRadius,this.life=void 0==a.life?60:a.life,this.ageing=1/this.life,this.friction=void 0==a.friction?1:a.friction,this.color=new THREE.Color(void 0==a.color?16777215:a.color),this.color2=void 0==a.color2?null:new THREE.Color(a.color2),this.position=void 0==a.position?new THREE.Vector3:a.position,this.rotation=void 0==a.rotation?new THREE.Vector3:a.rotation,this.sort=void 0==a.sort?!1:a.sort,this.pool=[],this.buffer=[],this.geometry=null,this.system=null,this.build()},bkcore.threejs.Particles.prototype.build=function(){this.geometry=new THREE.Geometry,this.geometry.dynamic=!0,this.pool=[],this.buffer=[];for(var a=0;a<this.max;++a){var b=new bkcore.threejs.Particle;this.pool.push(b),this.buffer.push(b),this.geometry.vertices.push(b.position),this.geometry.colors.push(b.color)}this.system=new THREE.ParticleSystem(this.geometry,this.material),this.system.position=this.position,this.system.rotation=this.rotation,this.system.sort=this.sort},bkcore.threejs.Particles.prototype.emit=function(a){for(var b=Math.min(a,this.pool.length),c=0;b>c;++c){var d=this.pool.pop();d.available=!1,d.position.copy(this.spawn).addSelf(this.randomVector().multiplySelf(this.spawnRadius)),d.velocity.copy(this.velocity).addSelf(this.randomVector().multiplySelf(this.randomness)),d.force.copy(this.force),d.basecolor.copy(this.color),void 0!=this.color2&&d.basecolor.lerpSelf(this.color2,Math.random()),d.life=1}},bkcore.threejs.Particles.prototype.randomVector=function(){return new THREE.Vector3(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1)},bkcore.threejs.Particles.prototype.update=function(a){for(var b,c,d=new THREE.Vector3,e=new THREE.Vector3,f=0;f<this.buffer.length;++f)b=this.buffer[f],b.available||(b.life-=this.ageing,b.life<=0&&!b.available?(b.reset(),this.pool.push(b)):(c=b.life>.5?1:b.life+.5,b.color.setRGB(c*b.basecolor.r,c*b.basecolor.g,c*b.basecolor.b),1!=this.friction&&b.velocity.multiplyScalar(this.friction),d.copy(b.force).multiplyScalar(a),b.velocity.addSelf(d),e.copy(b.velocity).multiplyScalar(a),b.position.addSelf(e)));this.spawnRate>0&&this.emit(this.spawnRate),this.geometry.verticesNeedUpdate=!0,this.geometry.colorsNeedUpdate=!0},bkcore.threejs.Particle=function(){this.position=new THREE.Vector3(-1e4,-1e4,-1e4),this.velocity=new THREE.Vector3,this.force=new THREE.Vector3,this.color=new THREE.Color(0),this.basecolor=new THREE.Color(0),this.life=0,this.available=!0},bkcore.threejs.Particle.prototype.reset=function(){this.position.set(0,-1e5,0),this.velocity.set(0,0,0),this.force.set(0,0,0),this.color.setRGB(0,0,0),this.basecolor.setRGB(0,0,0),this.life=0,this.available=!0};
//# sourceMappingURL=Particles.map