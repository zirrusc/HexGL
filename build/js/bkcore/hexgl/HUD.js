var bkcore=bkcore||{};bkcore.hexgl=bkcore.hexgl||{},bkcore.hexgl.HUD=function(a){this.width=a.width,this.height=a.height,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.ctx=this.canvas.getContext("2d"),this.ctx.textAlign="center",this.bg=a.bg,this.fgspeed=a.speed,this.fgshield=a.shield,this.speedFontRatio=24,this.speedBarRatio=2.91,this.shieldFontRatio=64,this.shieldBarYRatio=34,this.shieldBarWRatio=18.3,this.shieldBarHRatio=14.3,this.timeMarginRatio=18,this.timeFontRatio=19.2,this.font=a.font||"Arial",this.time="",this.message="",this.previousMessage="",this.messageTiming=0,this.messagePos=0,this.messagePosTarget=0,this.messagePosTargetRatio=12,this.messageA=1,this.messageAS=1,this.messageDuration=120,this.messageDurationD=120,this.messageDurationS=30,this.messageYRatio=34,this.messageFontRatio=10,this.messageFontRatioStart=6,this.messageFontRatioEnd=10,this.messageFontLerp=.4,this.messageLerp=.4,this.messageFontAlpha=.8,this.lapMarginRatio=14,this.lap="",this.lapSeparator="/",this.timeSeparators=["","'","''",""],this.step=0,this.maxStep=2},bkcore.hexgl.HUD.prototype.resize=function(a,b){this.width=a,this.height=b,this.canvas.width=a,this.canvas.height=b},bkcore.hexgl.HUD.prototype.display=function(a,b){this.messageTiming=0,""!=this.message&&(this.messageA=this.messageFontAlpha,this.messagePos=0,this.messagePosTarget=this.width/this.messagePosTargetRatio,this.previousMessage=this.message),this.messageFontRatio=this.messageFontRatioStart,this.messageAS=0,this.message=a,this.messageDuration=void 0==b?this.messageDurationD:60*b},bkcore.hexgl.HUD.prototype.updateLap=function(a,b){this.lap=a+this.lapSeparator+b},bkcore.hexgl.HUD.prototype.resetLap=function(){this.lap=""},bkcore.hexgl.HUD.prototype.updateTime=function(a){this.time=this.timeSeparators[0]+("00"+a.m).slice(-2)+this.timeSeparators[1]+("00"+a.s).slice(-2)+this.timeSeparators[2]+("000"+a.ms).slice(-3)+this.timeSeparators[3]},bkcore.hexgl.HUD.prototype.resetTime=function(){this.time=""},bkcore.hexgl.HUD.prototype.update=function(a,b,c,d){var e=this.width,f=this.height,g=e/2,h=f/2,i=this.bg.width,j=this.bg.height,k=j/i,l=e,m=l*k,n=f-m,o=0,p=m,q=e/this.speedBarRatio,r=q*b,s=e/this.shieldBarWRatio,t=e/this.shieldBarHRatio,u=t*d,v=e/this.shieldBarYRatio+t-u;if(0==this.step)this.ctx.clearRect(0,n,e,m),this.ctx.drawImage(this.bg,o,n,l,m),this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(r+p+g,n),this.ctx.lineTo(-(r+p)+g,n),this.ctx.lineTo(-r+g,f),this.ctx.lineTo(r+g,f),this.ctx.lineTo(r+p+g,n),this.ctx.clip(),this.ctx.drawImage(this.fgspeed,o,n,l,m),this.ctx.restore(),this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(-s+g,n+v),this.ctx.lineTo(s+g,n+v),this.ctx.lineTo(s+g,n+u+v),this.ctx.lineTo(-s+g,n+u+v),this.ctx.lineTo(-s+g,n+u),this.ctx.clip(),this.ctx.drawImage(this.fgshield,o,n,l,m),this.ctx.restore(),this.ctx.font=e/this.speedFontRatio+"px "+this.font,this.ctx.fillStyle="rgba(255, 255, 255, 0.8)",this.ctx.fillText(a,g,f-.57*m),this.ctx.font=e/this.shieldFontRatio+"px "+this.font,this.ctx.fillStyle="rgba(255, 255, 255, 0.4)",this.ctx.fillText(c,g,f-.44*m);else if(1==this.step){this.ctx.clearRect(0,0,e,n),""!=this.time&&(this.ctx.font=e/this.timeFontRatio+"px "+this.font,this.ctx.fillStyle="rgba(255, 255, 255, 0.8)",this.ctx.fillText(this.time,g,e/this.timeMarginRatio)),""!=this.lap&&(this.ctx.font=e/this.timeFontRatio+"px "+this.font,this.ctx.fillStyle="rgba(255, 255, 255, 0.8)",this.ctx.fillText(this.lap,e-e/this.lapMarginRatio,e/this.timeMarginRatio));var w=h-e/this.messageYRatio;this.messageTiming>this.messageDuration+2e3?(this.previousMessage="",this.message="",this.messageA=0):this.messageTiming>this.messageDuration&&""!=this.message&&(this.previousMessage=this.message,this.message="",this.messagePos=0,this.messagePosTarget=e/this.messagePosTargetRatio,this.messageA=this.messageFontAlpha),""!=this.previousMessage&&(this.messageA<.001?this.messageA=0:this.messageA+=(0-this.messageA)*this.messageLerp,this.messagePos+=(this.messagePosTarget-this.messagePos)*this.messageLerp,this.ctx.font=e/this.messageFontRatioEnd+"px "+this.font,this.ctx.fillStyle="rgba(255, 255, 255, "+this.messageA+")",this.ctx.fillText(this.previousMessage,g,w+this.messagePos)),""!=this.message&&(this.messageTiming<this.messageDurationS?(this.messageAS+=(this.messageFontAlpha-this.messageAS)*this.messageFontLerp,this.messageFontRatio+=(this.messageFontRatioEnd-this.messageFontRatio)*this.messageFontLerp):(this.messageAS=this.messageFontAlpha,this.messageFontRatio=this.messageFontRatioEnd),this.ctx.font=e/this.messageFontRatio+"px "+this.font,this.ctx.fillStyle="rgba(255, 255, 255, "+this.messageAS+")",this.ctx.fillText(this.message,g,w))}this.messageTiming++,this.step++,this.step==this.maxStep&&(this.step=0)};
//# sourceMappingURL=HUD.map