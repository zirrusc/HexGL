!function(a,b,c,d,e,f,g,h,i,j){function k(a){var b;if(l.future.inheritance)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);else gb(this,a)}function l(a){var b;if(a)gb(bb,a);else for(b in bb)bb.hasOwnProperty(b)&&delete bb[b];return this}function m(){}function n(a){return"string"===ib(a)}function o(a){return a&&a.getContext?a.getContext("2d"):i}function p(a){return a=gb({},a),a.masks=a.masks.slice(0),a}function q(a,b){var c;a.save(),c=p(b.transforms),b.savedTransforms.push(c)}function r(a,b,c,d){c[d]&&(b[d]=jb(c[d])?c[d].call(a,c):c[d])}function s(a,b,c){r(a,b,c,"fillStyle"),r(a,b,c,"strokeStyle"),b.lineWidth=c.strokeWidth,c.rounded?b.lineCap=b.lineJoin="round":(b.lineCap=c.strokeCap,b.lineJoin=c.strokeJoin,b.miterLimit=c.miterLimit),b.shadowOffsetX=c.shadowX,b.shadowOffsetY=c.shadowY,b.shadowBlur=c.shadowBlur,b.shadowColor=c.shadowColor,b.globalAlpha=c.opacity,b.globalCompositeOperation=c.compositing,c.imageSmoothing&&(b.webkitImageSmoothingEnabled=b.mozImageSmoothingEnabled=c.imageSmoothing)}function t(a,b,c){c.mask&&(c.autosave&&q(a,b),a.clip(),b.transforms.masks.push(c._args))}function u(a,b,c){c.closed&&b.closePath(),c.shadowStroke&&0!==c.strokeWidth?(b.stroke(),b.fill(),b.shadowColor="transparent",b.shadowBlur=0,b.stroke()):(b.fill(),"transparent"!==c.fillStyle&&(b.shadowColor="transparent"),0!==c.strokeWidth&&b.stroke()),c.closed||b.closePath(),c._transformed&&b.restore(),c.mask&&(a=z(a),t(b,a,c))}function v(a,b,c){b._toRad=b.inDegrees?kb/180:1,a.translate(b.x,b.y),a.rotate(b.rotate*b._toRad),a.translate(-b.x,-b.y),c&&(c.rotate+=b.rotate*b._toRad)}function w(a,b,c){1!==b.scale&&(b.scaleX=b.scaleY=b.scale),a.translate(b.x,b.y),a.scale(b.scaleX,b.scaleY),a.translate(-b.x,-b.y),c&&(c.scaleX*=b.scaleX,c.scaleY*=b.scaleY)}function x(a,b,c){b.translate&&(b.translateX=b.translateY=b.translate),a.translate(b.translateX,b.translateY),c&&(c.translateX+=b.translateX,c.translateY+=b.translateY)}function y(a,b,c,d,e){c._toRad=c.inDegrees?kb/180:1,c._transformed=g,b.save(),c.fromCenter||c._centered||d===j||(e===j&&(e=d),c.x+=d/2,c.y+=e/2,c._centered=g),c.rotate&&v(b,c,i),1===c.scale&&1===c.scaleX&&1===c.scaleY||w(b,c,i),(c.translate||c.translateX||c.translateY)&&x(b,c,i)}function z(b){var c,d=sb.dataCache;return d._canvas===b&&d._data?c=d._data:(c=a.data(b,"jCanvas"),c||(c={canvas:b,layers:[],layer:{names:{},groups:{}},eventHooks:{},intersecting:[],lastIntersected:i,cursor:a(b).css("cursor"),drag:{layer:i,dragging:h},event:{type:i,x:i,y:i},events:{},transforms:p(tb),savedTransforms:[],animating:h,animated:i,pixelRatio:1,scaled:h},a.data(b,"jCanvas",c)),d._canvas=b,d._data=c),c}function A(a,b,c){for(var d in l.events)l.events.hasOwnProperty(d)&&(c[d]||c.cursors&&c.cursors[d])&&B(a,b,c,d)}function B(a,b,c,d){window.ontouchstart!==j&&rb.touchEvents[d]&&(d=rb.touchEvents[d]),l.events[d](a,b),c._event=g}function C(a,b,c){var d,e,f;if(c.draggable||c.cursors){for(d=["mousedown","mousemove","mouseup"],f=0;f<d.length;f+=1)e=d[f],B(a,b,c,e);b.events.mouseoutdrag||(a.bind("mouseout.jCanvas",function(){var c=b.drag.layer;c&&(b.drag={},G(a,b,c,"dragcancel"),a.drawLayers())}),b.events.mouseoutdrag=g),c._event=g}}function D(a,b,c,d){a=b.layer.names,d?d.name!==j&&n(c.name)&&c.name!==d.name&&delete a[c.name]:d=c,n(d.name)&&(a[d.name]=c)}function E(a,b,c,d){a=b.layer.groups;var e,f,g,h;if(d){if(d.groups!==j&&c.groups!==i)for(f=0;f<c.groups.length;f+=1)if(e=c.groups[f],b=a[e]){for(h=0;h<b.length;h+=1)if(b[h]===c){g=h,b.splice(h,1);break}0===b.length&&delete a[e]}}else d=c;if(d.groups!==j&&d.groups!==i)for(f=0;f<d.groups.length;f+=1)e=d.groups[f],b=a[e],b||(b=a[e]=[],b.name=e),g===j&&(g=b.length),b.splice(g,0,c)}function F(a,b,c,d,e){d[c]&&b._running&&!b._running[c]&&(b._running[c]=g,d[c].call(a[0],b,e),b._running[c]=h)}function G(b,c,d,e,f){if(!d.disableEvents){var g;d.cursors&&(g=d.cursors[e]),-1!==a.inArray(g,eb)&&(g=fb.css+g),g&&b.css({cursor:g}),F(b,d,e,d,f),F(b,d,e,c.eventHooks,f),F(b,d,e,l.eventHooks,f)}}function H(b,c,d,e){var f=c._layer?d:c;return c._args=d,c.canvas=b,(c.draggable||c.dragGroups)&&(c.layer=g,c.draggable=g),c._method=e?e:c.method?a.fn[c.method]:c.type?a.fn[rb.drawings[c.type]]:function(){},c.layer&&!c._layer&&(d=a(b),b=z(b),e=b.layers,f.name===i||n(f.name)&&b.layer.names[f.name]===j)&&(f=new k(c),f.layer=g,f._layer=g,f._running={},f.data=f.data!==i?gb({},f.data):{},f.groups=f.groups!==i?f.groups.slice(0):[],D(d,b,f),E(d,b,f),A(d,b,f),C(d,b,f),c._event=f._event,f._method===a.fn.drawText&&d.measureText(f),f.index===i&&(f.index=e.length),e.splice(f.index,0,f),c._args=f,G(d,b,f,"add")),f}function I(a,b){var c,d;for(d=0;d<cb.length;d+=1)c=cb[d],a[c]!==j&&(a["_"+c]=a[c],db[c]=g,b&&delete a[c])}function J(a,b,c){var d,e,f,g;for(d in c)if(c.hasOwnProperty(d)&&(e=c[d],jb(e)&&(c[d]=e.call(a,b,d)),"object"===ib(e))){for(f in e)e.hasOwnProperty(f)&&(g=e[f],b[d]!==j&&(b[d+"."+f]=b[d][f],c[d+"."+f]=g));delete c[d]}return c}function K(c){var d,e,g=[],h=1;return c.match(/^([a-z]+|#[0-9a-f]+)$/gi)&&("transparent"===c&&(c="rgba(0,0,0,0)"),e=b.head,d=e.style.color,e.style.color=c,c=a.css(e,"color"),e.style.color=d),c.match(/^rgb/gi)&&(g=c.match(/(\d+(\.\d+)?)/gi),c.match(/%/gi)&&(h=2.55),g[0]*=h,g[1]*=h,g[2]*=h,g[3]=g[3]!==j?f(g[3]):1),g}function L(a){var b,c=3;for("array"!==ib(a.start)&&(a.start=K(a.start),a.end=K(a.end)),a.now=[],(1!==a.start[3]||1!==a.end[3])&&(c=4),b=0;c>b;b+=1)a.now[b]=a.start[b]+(a.end[b]-a.start[b])*a.pos,3>b&&(a.now[b]=lb(a.now[b]));1!==a.start[3]||1!==a.end[3]?a.now="rgba("+a.now.join(",")+")":(a.now.slice(0,3),a.now="rgb("+a.now.join(",")+")"),a.elem.nodeName?a.elem.style[a.prop]=a.now:a.elem[a.prop]=a.now}function M(a){l.events[a]=function(b,c){var d,e;e=c.event,d="mouseover"===a||"mouseout"===a?"mousemove":a,c.events[d]||(b.bind(d+".jCanvas",function(a){e.x=a.offsetX,e.y=a.offsetY,e.type=d,e.event=a,b.drawLayers({resetFire:g}),a.preventDefault()}),c.events[d]=g)}}function N(a,b,c){var d,e,f,g;(c=c._args)&&(a=z(a),d=a.event,d.x!==i&&d.y!==i&&(f=d.x*a.pixelRatio,g=d.y*a.pixelRatio,e=b.isPointInPath(f,g)||b.isPointInStroke&&b.isPointInStroke(f,g)),b=a.transforms,c.eventX=c.mouseX=d.x,c.eventY=c.mouseY=d.y,c.event=d.event,d=a.transforms.rotate,f=c.eventX,g=c.eventY,0!==d?(c._eventX=f*nb(-d)-g*mb(-d),c._eventY=g*nb(-d)+f*mb(-d)):(c._eventX=f,c._eventY=g),c._eventX/=b.scaleX,c._eventY/=b.scaleY,e&&a.intersecting.push(c),c.intersects=e)}function O(a){for(;0>a;)a+=2*kb;return a}function P(a,b,c,d){var e,f,g,h,i,j,k;c===d?k=j=0:(j=c.x,k=c.y),d.inDegrees||360!==d.end||(d.end=2*kb),d.start*=c._toRad,d.end*=c._toRad,d.start-=kb/2,d.end-=kb/2,i=kb/180*1,d.ccw&&(i*=-1),e=d.x+d.radius*nb(d.start+i),f=d.y+d.radius*mb(d.start+i),g=d.x+d.radius*nb(d.start),h=d.y+d.radius*mb(d.start),R(a,b,c,d,e,f,g,h),b.arc(d.x+j,d.y+k,d.radius,d.start,d.end,d.ccw),e=d.x+d.radius*nb(d.end+i),i=d.y+d.radius*mb(d.end+i),f=d.x+d.radius*nb(d.end),g=d.y+d.radius*mb(d.end),S(a,b,c,d,f,g,e,i)}function Q(a,b,c,d,e,f,g,h){var i,j;d.arrowRadius&&!c.closed&&(j=ob(h-f,g-e),j-=kb,a=c.strokeWidth*nb(j),i=c.strokeWidth*mb(j),c=g+d.arrowRadius*nb(j+d.arrowAngle/2),e=h+d.arrowRadius*mb(j+d.arrowAngle/2),f=g+d.arrowRadius*nb(j-d.arrowAngle/2),d=h+d.arrowRadius*mb(j-d.arrowAngle/2),b.moveTo(c-a,e-i),b.lineTo(g-a,h-i),b.lineTo(f-a,d-i),b.moveTo(g-a,h-i),b.lineTo(g+a,h+i),b.moveTo(g,h))}function R(a,b,c,d,e,f,h,i){d._arrowAngleConverted||(d.arrowAngle*=c._toRad,d._arrowAngleConverted=g),d.startArrow&&Q(a,b,c,d,e,f,h,i)}function S(a,b,c,d,e,f,h,i){d._arrowAngleConverted||(d.arrowAngle*=c._toRad,d._arrowAngleConverted=g),d.endArrow&&Q(a,b,c,d,e,f,h,i)}function T(a,b,c,d){var e,f,h;for(e=2,R(a,b,c,d,d.x2+c.x,d.y2+c.y,d.x1+c.x,d.y1+c.y),d.x1!==j&&d.y1!==j&&b.moveTo(d.x1+c.x,d.y1+c.y);g&&(f=d["x"+e],h=d["y"+e],f!==j&&h!==j);)b.lineTo(f+c.x,h+c.y),e+=1;e-=1,S(a,b,c,d,d["x"+(e-1)]+c.x,d["y"+(e-1)]+c.y,d["x"+e]+c.x,d["y"+e]+c.y)}function U(a,b,c,d){var e,f,h,i,k;for(e=2,R(a,b,c,d,d.cx1+c.x,d.cy1+c.y,d.x1+c.x,d.y1+c.y),d.x1!==j&&d.y1!==j&&b.moveTo(d.x1+c.x,d.y1+c.y);g&&(f=d["x"+e],h=d["y"+e],i=d["cx"+(e-1)],k=d["cy"+(e-1)],f!==j&&h!==j&&i!==j&&k!==j);)b.quadraticCurveTo(i+c.x,k+c.y,f+c.x,h+c.y),e+=1;e-=1,S(a,b,c,d,d["cx"+(e-1)]+c.x,d["cy"+(e-1)]+c.y,d["x"+e]+c.x,d["y"+e]+c.y)}function V(a,b,c,d){var e,f,h,i,k,l,m,n;for(e=2,f=1,R(a,b,c,d,d.cx1+c.x,d.cy1+c.y,c.x1+c.x,c.y1+c.y),c.x1!==j&&c.y1!==j&&b.moveTo(c.x1+c.x,c.y1+c.y);g&&(h=d["x"+e],i=d["y"+e],k=d["cx"+f],l=d["cy"+f],m=d["cx"+(f+1)],n=d["cy"+(f+1)],h!==j&&i!==j&&k!==j&&l!==j&&m!==j&&n!==j);)b.bezierCurveTo(k+c.x,l+c.y,m+c.x,n+c.y,h+c.x,i+c.y),e+=1,f+=2;e-=1,f-=2,S(a,b,c,d,d["cx"+(f+1)]+c.x,d["cy"+(f+1)]+c.y,d["x"+e]+c.x,d["y"+e]+c.y)}function W(a,b,c){return b*=a._toRad,b-=kb/2,c*nb(b)}function X(a,b,c){return b*=a._toRad,b-=kb/2,c*mb(b)}function Y(a,b,c,d){var e,f,h,i,k,l,m;for(c===d?k=i=0:(i=c.x,k=c.y),e=1,f=i=l=d.x+i,h=k=m=d.y+k,R(a,b,c,d,f+W(c,d.a1,d.l1),h+X(c,d.a1,d.l1),f,h),d.x!==j&&d.y!==j&&b.moveTo(f,h);g&&(f=d["a"+e],h=d["l"+e],f!==j&&h!==j);)i=l,k=m,l+=W(c,f,h),m+=X(c,f,h),b.lineTo(l,m),e+=1;S(a,b,c,d,i,k,l,m)}function Z(a,b){isNaN(Number(b.fontSize))||(b.fontSize+="px"),a.font=b.fontStyle+" "+b.fontSize+" "+b.fontFamily}function $(b,c,d,e){var g,h;if(g=sb.propCache,g.text===d.text&&g.fontStyle===d.fontStyle&&g.fontSize===d.fontSize&&g.fontFamily===d.fontFamily&&g.maxWidth===d.maxWidth&&g.lineHeight===d.lineHeight)d.width=g.width,d.height=g.height;else{for(d.width=c.measureText(e[0]).width,h=1;h<e.length;h+=1)g=c.measureText(e[h]).width,g>d.width&&(d.width=g);c=b.style.fontSize,b.style.fontSize=d.fontSize,d.height=f(a.css(b,"fontSize"))*e.length*d.lineHeight,b.style.fontSize=c}}function _(a,b){var c,d,e,f,g,h=b.maxWidth,i=b.text.split("\n"),j=[];for(e=0;e<i.length;e+=1){if(f=i[e],g=f.split(" "),c=[],d="",1===g.length||a.measureText(f).width<h)c=[f];else{for(f=0;f<g.length;f+=1)a.measureText(d+g[f]).width>h&&(""!==d&&c.push(d),d=""),d+=g[f],f!==g.length-1&&(d+=" ");c.push(d)}j=j.concat(c.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n"))}return j}var ab,bb,cb,db,eb,fb,gb=a.extend,hb=a.inArray,ib=a.type,jb=a.isFunction,kb=e.PI,lb=e.round,mb=e.sin,nb=e.cos,ob=e.atan2,pb=d.prototype.slice,qb=a.event.fix,rb={},sb={dataCache:{},propCache:{},imageCache:{}},tb={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]};a.fn.jCanvas=l,l.events={},l.eventHooks={},l.future={inheritance:!1},ab=new function(){gb(this,{align:"center",arrowAngle:90,arrowRadius:0,autosave:g,baseline:"middle",bringToFront:h,ccw:h,closed:h,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:g,cursors:i,disableEvents:h,draggable:h,dragGroups:i,groups:i,data:i,dx:i,dy:i,end:360,eventX:i,eventY:i,fillStyle:"transparent",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:g,height:i,imageSmoothing:g,inDegrees:g,index:i,lineHeight:1,layer:h,mask:h,maxWidth:i,miterLimit:10,name:i,opacity:1,r1:i,r2:i,radius:0,repeat:"repeat",respectAlign:h,rotate:0,rounded:h,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowStroke:h,shadowX:0,shadowY:0,sHeight:i,sides:0,source:"",spread:0,start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:i,sx:i,sy:i,text:"",translate:0,translateX:0,translateY:0,type:i,visible:g,width:i,x:0,y:0})},m.prototype=ab,bb=new m,k.prototype=bb,l.extend=function(b){return b.name&&(b.props&&gb(ab,b.props),a.fn[b.name]=function c(a){var d,e,f,g;for(e=0;e<this.length;e+=1)d=this[e],(f=o(d))&&(g=new k(a),H(d,g,a,c),s(d,f,g),b.fn.call(d,f,g));return this},b.type&&(rb.drawings[b.type]=b.name)),a.fn[b.name]},a.fn.getEventHooks=function(){var a;return a={},0!==this.length&&(a=this[0],a=z(a),a=a.eventHooks),a},a.fn.setEventHooks=function(b){var c,d;for(c=0;c<this.length;c+=1)a(this[c]),d=z(this[c]),gb(d.eventHooks,b);return this},a.fn.getLayers=function(a){var b,c,d,e,f=[];if(0!==this.length)if(b=this[0],c=z(b),c=c.layers,jb(a))for(e=0;e<c.length;e+=1)d=c[e],a.call(b,d)&&f.push(d);else f=c;return f},a.fn.getLayer=function(a){var b,c,d,e;if(0!==this.length)if(b=this[0],c=z(b),b=c.layers,e=ib(a),a&&a.layer)d=a;else if("number"===e)0>a&&(a=b.length+a),d=b[a];else if("regexp"===e){for(c=0;c<b.length;c+=1)if(n(b[c].name)&&b[c].name.match(a)){d=b[c];break}}else d=c.layer.names[a];return d},a.fn.getLayerGroup=function(a){var b,c,d,e=ib(a);if(0!==this.length)if(b=this[0],"array"===e)d=a;else if("regexp"===e){for(c in b=z(b),b=b.layer.groups)if(c.match(a)){d=b[c];break}}else b=z(b),d=b.layer.groups[a];return d},a.fn.getLayerIndex=function(a){var b=this.getLayers();return a=this.getLayer(a),hb(a,b)},a.fn.setLayer=function(b,c){var d,e,g,i,j,k,l;for(e=0;e<this.length;e+=1)if(d=a(this[e]),g=z(this[e]),i=a(this[e]).getLayer(b)){D(d,g,i,c),E(d,g,i,c);for(j in c)c.hasOwnProperty(j)&&(k=c[j],l=ib(k),"object"===l?i[j]=gb({},k):"array"===l?i[j]=k.slice(0):"string"===l?0===k.indexOf("+=")?i[j]+=f(k.substr(2)):0===k.indexOf("-=")?i[j]-=f(k.substr(2)):i[j]=k:i[j]=k);A(d,g,i),C(d,g,i),a.isEmptyObject(c)===h&&G(d,g,i,"change",c)}return this},a.fn.setLayers=function(b,c){var d,e,f,g;for(e=0;e<this.length;e+=1)for(d=a(this[e]),f=d.getLayers(c),g=0;g<f.length;g+=1)d.setLayer(f[g],b);return this},a.fn.setLayerGroup=function(b,c){var d,e,f,g;for(e=0;e<this.length;e+=1)if(d=a(this[e]),f=d.getLayerGroup(b))for(g=0;g<f.length;g+=1)d.setLayer(f[g],c);return this},a.fn.moveLayer=function(b,c){var d,e,f,g,h;for(e=0;e<this.length;e+=1)d=a(this[e]),f=z(this[e]),g=f.layers,(h=d.getLayer(b))&&(h.index=hb(h,g),g.splice(h.index,1),g.splice(c,0,h),0>c&&(c=g.length+c),h.index=c,G(d,f,h,"move"));return this},a.fn.removeLayer=function(b){var c,d,e,f,g;for(d=0;d<this.length;d+=1)c=a(this[d]),e=z(this[d]),f=c.getLayers(),(g=c.getLayer(b))&&(g.index=hb(g,f),f.splice(g.index,1),D(c,e,g,{name:i}),E(c,e,g,{groups:i}),G(c,e,g,"remove"));return this},a.fn.removeLayers=function(b){var c,d,e,f,g,h;for(d=0;d<this.length;d+=1){for(c=a(this[d]),e=z(this[d]),f=c.getLayers(b),h=0;h<f.length;h+=1)g=f[h],c.removeLayer(g),h-=1;e.layer.names={},e.layer.groups={}}return this},a.fn.removeLayerGroup=function(b){var c,d,e,f;if(b!==j)for(d=0;d<this.length;d+=1)if(c=a(this[d]),z(this[d]),c.getLayers(),e=c.getLayerGroup(b))for(e=e.slice(0),f=0;f<e.length;f+=1)c.removeLayer(e[f]);return this},a.fn.addLayerToGroup=function(b,c){var d,e,f,g=[c];for(e=0;e<this.length;e+=1)d=a(this[e]),f=d.getLayer(b),f.groups&&(g=f.groups.slice(0),-1===hb(c,f.groups)&&g.push(c)),d.setLayer(f,{groups:g});return this},a.fn.removeLayerFromGroup=function(b,c){var d,e,f,g,h=[];for(e=0;e<this.length;e+=1)d=a(this[e]),f=d.getLayer(b),f.groups&&(g=hb(c,f.groups),-1!==g&&(h=f.groups.slice(0),h.splice(g,1),d.setLayer(f,{groups:h})));return this},eb=["grab","grabbing","zoom-in","zoom-out"],fb=function(){var a=getComputedStyle(b.documentElement,""),a=(pb.call(a).join("").match(/-(moz|webkit|ms)-/)||""===a.OLink&&["","o"])[1];return{lowercase:a,css:"-"+a+"-",js:a[0].toUpperCase()+a.substr(1)}}(),a.fn.triggerLayerEvent=function(b,c){var d,e,f;for(e=0;e<this.length;e+=1)d=a(this[e]),f=z(this[e]),(b=d.getLayer(b))&&G(d,f,b,c);return this},a.fn.drawLayer=function(b){var c,d,e;for(c=0;c<this.length;c+=1)d=a(this[c]),o(this[c]),(e=d.getLayer(b))&&e.visible&&e._method&&(e._next=i,e._method.call(d,e));return this},a.fn.drawLayers=function(b){var c,d,e,f,j,k,l,m,n=gb({},b);for(n.index||(n.index=0),c=0;c<this.length;c+=1)if(b=a(this[c]),d=o(this[c])){for(k=z(this[c]),n.clear!==h&&b.clearCanvas(),d=k.layers,j=n.index;j<d.length&&(e=d[j],e.index=j,n.resetFire&&(e._fired=h),l=b,m=e,f=j+1,m&&m.visible&&m._method&&(m._next=f?f:i,m._method.call(l,m)),e._masks=k.transforms.masks.slice(0),e._method!==a.fn.drawImage||!e.visible);j+=1);e=k;var q=f=m=l=void 0;for(l=i,m=e.intersecting.length-1;m>=0;m-=1)if(l=e.intersecting[m],l._masks){for(q=l._masks.length-1;q>=0;q-=1)if(f=l._masks[q],!f.intersects){l.intersects=h;break}if(l.intersects)break}if(e=l,l=k.event,m=l.type,k.drag.layer){f=b;var q=k,r=m,s=void 0,t=void 0,u=void 0,v=u=void 0,w=void 0,u=s=s=u=void 0,u=q.drag,v=(t=u.layer)&&t.dragGroups||[],s=q.layers;if("mousemove"===r||"touchmove"===r){if(u.dragging||(u.dragging=g,t.dragging=g,t.bringToFront&&(s.splice(t.index,1),t.index=s.push(t)),t._startX=t.x,t._startY=t.y,t._endX=t._eventX,t._endY=t._eventY,G(f,q,t,"dragstart")),u.dragging)for(s=t._eventX-(t._endX-t._startX),u=t._eventY-(t._endY-t._startY),t.dx=s-t.x,t.dy=u-t.y,t.x=s,t.y=u,G(f,q,t,"drag"),s=0;s<v.length;s+=1)if(u=v[s],w=q.layer.groups[u],t.groups&&w)for(u=0;u<w.length;u+=1)w[u]!==t&&(w[u].x+=t.dx,w[u].y+=t.dy)}else("mouseup"===r||"touchend"===r)&&(u.dragging&&(t.dragging=h,u.dragging=h,G(f,q,t,"dragstop")),q.drag={})}f=k.lastIntersected,f===i||e===f||!f._hovered||f._fired||k.drag.dragging||(k.lastIntersected=i,f._fired=g,f._hovered=h,G(b,k,f,"mouseout"),b.css({cursor:k.cursor})),e&&(e[m]||rb.mouseEvents[m]&&(m=rb.mouseEvents[m]),e._event&&e.intersects&&(k.lastIntersected=e,!(e.mouseover||e.mouseout||e.cursors)||k.drag.dragging||e._hovered||e._fired||(e._fired=g,e._hovered=g,G(b,k,e,"mouseover")),e._fired||(e._fired=g,l.type=i,G(b,k,e,m)),!e.draggable||e.disableEvents||"mousedown"!==m&&"touchstart"!==m||(k.drag.layer=e))),e!==i||k.drag.dragging||b.css({cursor:k.cursor}),j===d.length&&(k.intersecting.length=0,k.transforms=p(tb),k.savedTransforms.length=0)}return this},a.fn.addLayer=function(a){var b,c;for(b=0;b<this.length;b+=1)(c=o(this[b]))&&(c=new k(a),c.layer=g,H(this[b],c,a));return this},cb=["width","height","opacity","lineHeight"],db={},a.fn.animateLayer=function(){function b(a,b,c){return function(){var d,e;for(e=0;e<cb.length;e+=1)d=cb[e],c[d]=c["_"+d];for(var f in c)c.hasOwnProperty(f)&&-1!==f.indexOf(".")&&delete c[f];b.animating&&b.animated!==c||a.drawLayers(),c._animating=h,b.animating=h,b.animated=i,m[4]&&m[4].call(a[0],c),G(a,b,c,"animateend")}}function c(a,b,c){return function(d,e){var f,h,i=!1;"_"===e.prop[0]&&(i=!0,e.prop=e.prop.replace("_",""),c[e.prop]=c["_"+e.prop]),-1!==e.prop.indexOf(".")&&(f=e.prop.split("."),h=f[0],f=f[1],c[h]&&(c[h][f]=e.now)),c._pos!==e.pos&&(c._pos=e.pos,c._animating||b.animating||(c._animating=g,b.animating=g,b.animated=c),b.animating&&b.animated!==c||a.drawLayers()),m[5]&&m[5].call(a[0],d,e,c),G(a,b,c,"animate",e),i&&(e.prop="_"+e.prop)}}var d,e,f,k,l,m=pb.call(arguments,0);for("object"===ib(m[2])?(m.splice(2,0,m[2].duration||i),m.splice(3,0,m[3].easing||i),m.splice(4,0,m[4].complete||i),m.splice(5,0,m[5].step||i)):(m[2]===j?(m.splice(2,0,i),m.splice(3,0,i),m.splice(4,0,i)):jb(m[2])&&(m.splice(2,0,i),m.splice(3,0,i)),m[3]===j?(m[3]=i,m.splice(4,0,i)):jb(m[3])&&m.splice(3,0,i)),e=0;e<this.length;e+=1)d=a(this[e]),(f=o(this[e]))&&(f=z(this[e]),(k=d.getLayer(m[0]))&&k._method!==a.fn.draw&&(l=gb({},m[1]),l=J(this[e],k,l),I(l,g),I(k),k.style=db,a(k).animate(l,{duration:m[2],easing:a.easing[m[3]]?m[3]:i,complete:b(d,f,k),step:c(d,f,k)}),G(d,f,k,"animatestart")));return this},a.fn.animateLayerGroup=function(b){var c,d,e,f,g=pb.call(arguments,0);for(d=0;d<this.length;d+=1)if(c=a(this[d]),e=c.getLayerGroup(b))for(f=0;f<e.length;f+=1)g[0]=e[f],c.animateLayer.apply(c,g);return this},a.fn.delayLayer=function(b,c){var d,e,f,g;for(c=c||0,e=0;e<this.length;e+=1)d=a(this[e]),f=z(this[e]),(g=d.getLayer(b))&&(a(g).delay(c),G(d,f,g,"delay"));return this},a.fn.delayLayerGroup=function(b,c){var d,e,f,g,h;for(c=c||0,e=0;e<this.length;e+=1)if(d=a(this[e]),f=d.getLayerGroup(b))for(h=0;h<f.length;h+=1)g=f[h],d.delayLayer(g,c);return this},a.fn.stopLayer=function(b,c){var d,e,f,g;for(e=0;e<this.length;e+=1)d=a(this[e]),f=z(this[e]),(g=d.getLayer(b))&&(a(g).stop(c),G(d,f,g,"stop"));return this},a.fn.stopLayerGroup=function(b,c){var d,e,f,g,h;for(e=0;e<this.length;e+=1)if(d=a(this[e]),f=d.getLayerGroup(b))for(h=0;h<f.length;h+=1)g=f[h],d.stopLayer(g,c);return this},function(b){var c;for(c=0;c<b.length;c+=1)a.fx.step[b[c]]=L}("color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" ")),rb.touchEvents={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},rb.mouseEvents={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"},function(a){var b;for(b=0;b<a.length;b+=1)M(a[b])}("click dblclick mousedown mouseup mousemove mouseover mouseout touchstart touchmove touchend".split(" ")),a.event.fix=function(b){var c,d;return b=qb.call(a.event,b),(c=b.originalEvent)&&(d=c.changedTouches,b.pageX!==j&&b.offsetX===j?(c=a(b.currentTarget).offset())&&(b.offsetX=b.pageX-c.left,b.offsetY=b.pageY-c.top):d&&(c=a(b.currentTarget).offset())&&(b.offsetX=d[0].pageX-c.left,b.offsetY=d[0].pageY-c.top)),b},rb.drawings={arc:"drawArc",bezier:"drawBezier",ellipse:"drawEllipse","function":"draw",image:"drawImage",line:"drawLine",path:"drawPath",polygon:"drawPolygon",slice:"drawSlice",quadratic:"drawQuadratic",rectangle:"drawRect",text:"drawText",vector:"drawVector"},a.fn.draw=function ub(b){var c,d,e=new k(b);if(rb.drawings[e.type])this[rb.drawings[e.type]](b);else for(c=0;c<this.length;c+=1)a(this[c]),(d=o(this[c]))&&(e=new k(b),H(this[c],e,b,ub),e.visible&&e.fn&&e.fn.call(this[c],d,e));return this},a.fn.clearCanvas=function vb(a){var b,c,d=new k(a);for(b=0;b<this.length;b+=1)(c=o(this[b]))&&(d.width===i||d.height===i?(c.save(),c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,this[b].width,this[b].height),c.restore()):(H(this[b],d,a,vb),y(this[b],c,d,d.width,d.height),c.clearRect(d.x-d.width/2,d.y-d.height/2,d.width,d.height),d._transformed&&c.restore()));return this},a.fn.saveCanvas=function wb(a){var b,c,d,e,f;for(b=0;b<this.length;b+=1)if(c=o(this[b]))for(e=z(this[b]),d=new k(a),H(this[b],d,a,wb),f=0;f<d.count;f+=1)q(c,e);return this},a.fn.restoreCanvas=function xb(a){var b,c,d,e,f;for(b=0;b<this.length;b+=1)if(c=o(this[b]))for(e=z(this[b]),d=new k(a),H(this[b],d,a,xb),f=0;f<d.count;f+=1){var g=c,h=e;0===h.savedTransforms.length?h.transforms=p(tb):(g.restore(),h.transforms=h.savedTransforms.pop())}return this},a.fn.rotateCanvas=function yb(a){var b,c,d,e;for(b=0;b<this.length;b+=1)(c=o(this[b]))&&(e=z(this[b]),d=new k(a),H(this[b],d,a,yb),d.autosave&&q(c,e),v(c,d,e.transforms));return this},a.fn.scaleCanvas=function zb(a){var b,c,d,e;for(b=0;b<this.length;b+=1)(c=o(this[b]))&&(e=z(this[b]),d=new k(a),H(this[b],d,a,zb),d.autosave&&q(c,e),w(c,d,e.transforms));return this},a.fn.translateCanvas=function Ab(a){var b,c,d,e;for(b=0;b<this.length;b+=1)(c=o(this[b]))&&(e=z(this[b]),d=new k(a),H(this[b],d,a,Ab),d.autosave&&q(c,e),x(c,d,e.transforms));return this},a.fn.drawRect=function Bb(a){var b,c,d,e,f,i,j,l;for(b=0;b<this.length;b+=1)(c=o(this[b]))&&(d=new k(a),H(this[b],d,a,Bb),d.visible&&(s(this[b],c,d),y(this[b],c,d,d.width,d.height),c.beginPath(),e=d.x-d.width/2,f=d.y-d.height/2,(l=d.cornerRadius)?(i=d.x+d.width/2,j=d.y+d.height/2,0>i-e-2*l&&(l=(i-e)/2),0>j-f-2*l&&(l=(j-f)/2),c.moveTo(e+l,f),c.lineTo(i-l,f),c.arc(i-l,f+l,l,3*kb/2,2*kb,h),c.lineTo(i,j-l),c.arc(i-l,j-l,l,0,kb/2,h),c.lineTo(e+l,j),c.arc(e+l,j-l,l,kb/2,kb,h),c.lineTo(e,f+l),c.arc(e+l,f+l,l,kb,3*kb/2,h),d.closed=g):c.rect(e,f,d.width,d.height),N(this[b],c,d),u(this[b],c,d)));return this},a.fn.drawArc=function Cb(a){var b,c,d;for(b=0;b<this.length;b+=1)(c=o(this[b]))&&(d=new k(a),H(this[b],d,a,Cb),d.visible&&(s(this[b],c,d),y(this[b],c,d,2*d.radius),c.beginPath(),P(this[b],c,d,d),N(this[b],c,d),u(this[b],c,d)));return this},a.fn.drawEllipse=function Db(a){var b,c,d,e,f;for(b=0;b<this.length;b+=1)(c=o(this[b]))&&(d=new k(a),H(this[b],d,a,Db),d.visible&&(s(this[b],c,d),y(this[b],c,d,d.width,d.height),e=4/3*d.width,f=d.height,c.beginPath(),c.moveTo(d.x,d.y-f/2),c.bezierCurveTo(d.x-e/2,d.y-f/2,d.x-e/2,d.y+f/2,d.x,d.y+f/2),c.bezierCurveTo(d.x+e/2,d.y+f/2,d.x+e/2,d.y-f/2,d.x,d.y-f/2),N(this[b],c,d),d.closed=g,u(this[b],c,d)));return this},a.fn.drawPolygon=function Eb(a){var b,c,d,e,f,h,i,j,l,m;for(b=0;b<this.length;b+=1)if((c=o(this[b]))&&(d=new k(a),H(this[b],d,a,Eb),d.visible)){for(s(this[b],c,d),y(this[b],c,d,2*d.radius),f=2*kb/d.sides,h=f/2,e=h+kb/2,i=d.radius*nb(h),c.beginPath(),m=0;m<d.sides;m+=1)j=d.x+d.radius*nb(e),l=d.y+d.radius*mb(e),c.lineTo(j,l),d.concavity&&(j=d.x+(i+-i*d.concavity)*nb(e+h),l=d.y+(i+-i*d.concavity)*mb(e+h),c.lineTo(j,l)),e+=f;N(this[b],c,d),d.closed=g,u(this[b],c,d)}return this},a.fn.drawSlice=function Fb(b){var c,d,e,f,h;for(c=0;c<this.length;c+=1)a(this[c]),(d=o(this[c]))&&(e=new k(b),H(this[c],e,b,Fb),e.visible&&(s(this[c],d,e),y(this[c],d,e,2*e.radius),e.start*=e._toRad,e.end*=e._toRad,e.start-=kb/2,e.end-=kb/2,e.start=O(e.start),e.end=O(e.end),e.end<e.start&&(e.end+=2*kb),f=(e.start+e.end)/2,h=e.radius*e.spread*nb(f),f=e.radius*e.spread*mb(f),e.x+=h,e.y+=f,d.beginPath(),d.arc(e.x,e.y,e.radius,e.start,e.end,e.ccw),d.lineTo(e.x,e.y),N(this[c],d,e),e.closed=g,u(this[c],d,e)));return this},a.fn.drawLine=function Gb(a){var b,c,d;for(b=0;b<this.length;b+=1)(c=o(this[b]))&&(d=new k(a),H(this[b],d,a,Gb),d.visible&&(s(this[b],c,d),y(this[b],c,d),c.beginPath(),T(this[b],c,d,d),N(this[b],c,d),u(this[b],c,d)));return this},a.fn.drawQuadratic=function Hb(a){var b,c,d;for(b=0;b<this.length;b+=1)(c=o(this[b]))&&(d=new k(a),H(this[b],d,a,Hb),d.visible&&(s(this[b],c,d),y(this[b],c,d),c.beginPath(),U(this[b],c,d,d),N(this[b],c,d),u(this[b],c,d)));return this},a.fn.drawBezier=function Ib(a){var b,c,d;for(b=0;b<this.length;b+=1)(c=o(this[b]))&&(d=new k(a),H(this[b],d,a,Ib),d.visible&&(s(this[b],c,d),y(this[b],c,d),c.beginPath(),V(this[b],c,d,d),N(this[b],c,d),u(this[b],c,d)));return this},a.fn.drawVector=function Jb(a){var b,c,d;for(b=0;b<this.length;b+=1)(c=o(this[b]))&&(d=new k(a),H(this[b],d,a,Jb),d.visible&&(s(this[b],c,d),y(this[b],c,d),c.beginPath(),Y(this[b],c,d,d),N(this[b],c,d),u(this[b],c,d)));return this},a.fn.drawPath=function Kb(a){var b,c,d,e,f;for(b=0;b<this.length;b+=1)if((c=o(this[b]))&&(d=new k(a),H(this[b],d,a,Kb),d.visible)){for(s(this[b],c,d),y(this[b],c,d),c.beginPath(),e=1;g&&(f=d["p"+e],f!==j);)f=new k(f),"line"===f.type?T(this[b],c,d,f):"quadratic"===f.type?U(this[b],c,d,f):"bezier"===f.type?V(this[b],c,d,f):"vector"===f.type?Y(this[b],c,d,f):"arc"===f.type&&P(this[b],c,d,f),e+=1;N(this[b],c,d),u(this[b],c,d)}return this},a.fn.drawText=function Lb(b){var c,d,e,f,g,h,j;for(c=0;c<this.length;c+=1)if(a(this[c]),(d=o(this[c]))&&(e=new k(b),f=H(this[c],e,b,Lb),e.visible)){for(s(this[c],d,e),d.textBaseline=e.baseline,d.textAlign=e.align,Z(d,e),g=e.maxWidth!==i?_(d,e):e.text.toString().split("\n"),$(this[c],d,e,g),f&&(f.width=e.width,f.height=e.height),y(this[c],d,e,e.width,e.height),h=e.x,"left"===e.align?e.respectAlign?e.x+=e.width/2:h-=e.width/2:"right"===e.align&&(e.respectAlign?e.x-=e.width/2:h+=e.width/2),f=0;f<g.length;f+=1)d.shadowColor=e.shadowColor,j=e.y+f*e.height/g.length-(g.length-1)*e.height/g.length/2,d.fillText(g[f],h,j),"transparent"!==e.fillStyle&&(d.shadowColor="transparent"),d.strokeText(g[f],h,j);e._event&&(d.beginPath(),d.rect(e.x-e.width/2,e.y-e.height/2,e.width,e.height),N(this[c],d,e),d.closePath()),e._transformed&&d.restore()}return sb.propCache=e,this},a.fn.measureText=function(a){var b,c;return b=this.getLayer(a),(!b||b&&!b._layer)&&(b=new k(a)),(a=o(this[0]))&&(Z(a,b),c=_(a,b),$(this[0],a,b,c)),b},a.fn.drawImage=function Mb(b){function d(b,c,d,e,f){return function(){var j=a(b);s(b,c,e),e.width===i&&e.sWidth===i&&(e.width=e.sWidth=q.width),e.height===i&&e.sHeight===i&&(e.height=e.sHeight=q.height),f&&(f.width=e.width,f.height=e.height),e.sWidth!==i&&e.sHeight!==i&&e.sx!==i&&e.sy!==i?(e.width===i&&(e.width=e.sWidth),e.height===i&&(e.height=e.sHeight),e.cropFromCenter||(e.sx+=e.sWidth/2,e.sy+=e.sHeight/2),0>e.sy-e.sHeight/2&&(e.sy=e.sHeight/2),e.sy+e.sHeight/2>q.height&&(e.sy=q.height-e.sHeight/2),0>e.sx-e.sWidth/2&&(e.sx=e.sWidth/2),e.sx+e.sWidth/2>q.width&&(e.sx=q.width-e.sWidth/2),y(b,c,e,e.width,e.height),c.drawImage(q,e.sx-e.sWidth/2,e.sy-e.sHeight/2,e.sWidth,e.sHeight,e.x-e.width/2,e.y-e.height/2,e.width,e.height)):(y(b,c,e,e.width,e.height),c.drawImage(q,e.x-e.width/2,e.y-e.height/2,e.width,e.height)),c.beginPath(),c.rect(e.x-e.width/2,e.y-e.height/2,e.width,e.height),N(b,c,e),c.closePath(),e._transformed&&c.restore(),t(c,d,e),e.layer?G(j,d,f,"load"):e.load&&e.load.call(j[0],f),e.layer&&(f._masks=d.transforms.masks.slice(0),e._next&&j.drawLayers({clear:h,resetFire:g,index:e._next}))}}var e,f,l,m,n,p,q,r,u,v=sb.imageCache;for(f=0;f<this.length;f+=1)e=this[f],(l=o(this[f]))&&(m=z(this[f]),n=new k(b),p=H(this[f],n,b,Mb),n.visible&&(u=n.source,r=u.getContext,u.src||r?q=u:u&&(v[u]!==j?q=v[u]:(q=new c,q.src=u,v[u]=q)),q&&(q.complete||r?d(e,l,m,n,p)():(a(q).bind("load",d(e,l,m,n,p)),q.src=q.src))));return this},a.fn.createPattern=function(b){function d(){h=e.createPattern(g,f.repeat),f.load&&f.load.call(l[0],h)}var e,f,g,h,j,l=this;return(e=o(l[0]))?(f=new k(b),j=f.source,jb(j)?(g=a("<canvas />")[0],g.width=f.width,g.height=f.height,b=o(g),j.call(g,b),d()):(b=j.getContext,j.src||b?g=j:(g=new c,g.src=j),g.complete||b?d():(a(g).bind("load",d),g.src=g.src))):h=i,h},a.fn.createGradient=function(a){var b,c,d,e,f,g,h,l,m=[];if(a=new k(a),b=o(this[0])){for(a.x1=a.x1||0,a.y1=a.y1||0,a.x2=a.x2||0,a.y2=a.y2||0,b=a.r1!==i&&a.r2!==i?b.createRadialGradient(a.x1,a.y1,a.r1,a.x2,a.y2,a.r2):b.createLinearGradient(a.x1,a.y1,a.x2,a.y2),f=1;a["c"+f]!==j;f+=1)m.push(a["s"+f]!==j?a["s"+f]:i);for(c=m.length,m[0]===i&&(m[0]=0),m[c-1]===i&&(m[c-1]=1),f=0;c>f;f+=1){if(m[f]!==i){for(h=1,l=0,d=m[f],g=f+1;c>g;g+=1){if(m[g]!==i){e=m[g];break}h+=1}d>e&&(m[g]=m[f])}else m[f]===i&&(l+=1,m[f]=d+(e-d)/h*l);b.addColorStop(m[f],a["c"+(f+1)])}}else b=i;return b},a.fn.setPixels=function Nb(a){var b,c,d,e,f,g,h,j,l;for(c=0;c<this.length;c+=1)if(b=this[c],(d=o(b))&&(e=new k(a),H(b,e,a,Nb),y(this[c],d,e,e.width,e.height),(e.width===i||e.height===i)&&(e.width=b.width,e.height=b.height,e.x=e.width/2,e.y=e.height/2),0!==e.width&&0!==e.height)){if(g=d.getImageData(e.x-e.width/2,e.y-e.height/2,e.width,e.height),h=g.data,l=h.length,e.each)for(j=0;l>j;j+=4)f={r:h[j],g:h[j+1],b:h[j+2],a:h[j+3]},e.each.call(b,f,e),h[j]=f.r,h[j+1]=f.g,h[j+2]=f.b,h[j+3]=f.a;d.putImageData(g,e.x-e.width/2,e.y-e.height/2),d.restore()}return this},a.fn.getCanvasImage=function(a,b){var c,d=i;return 0!==this.length&&(c=this[0],c.toDataURL&&(b===j&&(b=1),d=c.toDataURL("image/"+a,b))),d},a.fn.detectPixelRatio=function(b){var c,d,e,f,h,i,j;for(d=0;d<this.length;d+=1)c=this[d],a(this[d]),e=o(c),j=z(this[d]),j.scaled||(f=window.devicePixelRatio||1,h=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,f/=h,1!==f&&(h=c.width,i=c.height,c.width=h*f,c.height=i*f,c.style.width=h+"px",c.style.height=i+"px",e.scale(f,f)),j.pixelRatio=f,j.scaled=g,b&&b.call(c,f));return this},l.clearCache=function(){for(var a in sb)sb.hasOwnProperty(a)&&(sb[a]={})},a.support.canvas=a("<canvas />")[0].getContext!==j,l.defaults=ab,l.prefs=bb,l.setGlobalProps=s,l.transformShape=y,l.detectEvents=N,l.closePath=u,a.jCanvas=l}(jQuery,document,Image,Array,Math,parseFloat,!0,!1,null);
//# sourceMappingURL=jcanvas.map