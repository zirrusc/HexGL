function getArgs(){for(var a,b=new Object,c=window.location.search.substring(1).split("&"),d=0;d<c.length;d++)a=c[d].split("="),b[a[0]]=a[1];return b}function initSocket(){socket=io.connect(),socket.on("added_room_mobile"+id,function(a){console.log("received",a),roomid=a.roomid,$("#pinBox").hide(),authoricated=!0,$(".modal-backdrop").remove(),initCanvas()}),socket.on("failed_add_room_mobile"+id,function(){location.href="/mobile.html?invalid_pin=1"})}function resizeCanvas(){var a=$("#handle"),b=document.body,c=document.documentElement;a.width(Math.max(b.clientWidth,b.scrollWidth,c.scrollWidth,c.clientWidth)),a.height(Math.max(b.clientHeight,b.scrollHeight,c.scrollHeight,c.clientHeight))}function initCanvas(){$("#handle");resizeCanvas(),$(window).on("orientationchange",resizeCanvas),$(window).on("resize",resizeCanvas),$("canvas").drawRect({fillStyle:"#000",x:0,y:0,width:2e5,height:4e5}),$("#handle").drawText({fillStyle:"#9cf",strokeStyle:"#25a",strokeWidth:2,x:150,y:100,fontSize:48,fontFamily:"Verdana, sans-serif",text:"Hello"}),$("canvas").drawArc({strokeStyle:"#dd",strokeWidth:5,x:100,y:100,radius:50})}function clickedPinButton(){var a=$("#pinBoxValue").val().replace(" ","");ready&&socket.emit("add_room_mobile",{id:id,roomid:a})}function preventTouchEvents(){function a(a){a.preventDefault()}$(document).bind("touchmove",a),$(document).bind("gesturestart",a),$(document).bind("gesturechange",a),$(document).bind("gestureend",a),window.ondeviceorientation=function(a){authoricated&&(last_orientation_event=a,socket.emit("report_motion",{id:id,roomid:roomid,x:a.alpha-base_x,y:a.beta,z:a.gamma,ch:a.webkitCompassHeading,ca:a.webkitCompassAccuracy,e:"window.ondeviceorientation"}))}}var id=String(Math.floor(1e6*Math.random())),roomid,socket,ready=!1,authoricated=!1,base_x=0,last_orientation_event;$(function(){var a=getArgs();initSocket(),window.scrollTo(0,0),preventTouchEvents(),$(".navbar-collapse").mousedown("li",function(){$(".navbar-collapse").collapse("hide")}),1==a.invalid_pin&&($("#pinBoxAdvice").show(),$("#pinBoxAdvice").text("Pin が違うよ")),$("#pinBoxOk").bind("touchend",clickedPinButton),$("#pinBoxOk").bind("click",clickedPinButton),$("#pinBox").modal("show"),$("#pinBoxValue").text(""),$("#pinBoxValue").focus(),$("#topbar-reset-position").mousedown(function(){base_x=last_orientation_event.alpha}),ready=!0});
//# sourceMappingURL=mobile2.map